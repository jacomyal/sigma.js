<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-advanced/migration-v2-v3" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Migrating from v2 to v3 | sigma.js</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://www.sigmajs.org/docs/advanced/migration-v2-v3"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="theme-color" content="#e22653"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Migrating from v2 to v3 | sigma.js"><meta data-rh="true" name="description" content="This guide will help users migrating their applications from sigma v2.\ to v3.\."><meta data-rh="true" property="og:description" content="This guide will help users migrating their applications from sigma v2.\ to v3.\."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://www.sigmajs.org/docs/advanced/migration-v2-v3"><link data-rh="true" rel="alternate" href="https://www.sigmajs.org/docs/advanced/migration-v2-v3" hreflang="en"><link data-rh="true" rel="alternate" href="https://www.sigmajs.org/docs/advanced/migration-v2-v3" hreflang="x-default"><link rel="preconnect" href="https://matomo.ouestware.com/">
<script>var _paq=window._paq=window._paq||[];_paq.push(["setRequestMethod","POST"]),_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),_paq.push(["enableHeartBeatTimer"]),function(){var e="https://matomo.ouestware.com/";_paq.push(["setRequestMethod","POST"]),_paq.push(["setTrackerUrl",e+"matomo.php"]),_paq.push(["setSiteId","26"]);var a=document,t=a.createElement("script"),p=a.getElementsByTagName("script")[0];t.type="text/javascript",t.async=!0,t.src=e+"matomo.js",p.parentNode.insertBefore(t,p)}()</script><link rel="stylesheet" href="/assets/css/styles.ac0f26fa.css">
<script src="/assets/js/runtime~main.857be78f.js" defer="defer"></script>
<script src="/assets/js/main.1d211a62.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_G6ar" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo-sigma-ruby.svg" alt="sigma.js logo"></div><b class="navbar__title text--truncate"><span class="text-ruby">sigma</span><span class="text-grey">.js</span></b></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/jacomyal/sigma.js" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_awgD"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_OLSw colorModeToggle_Hg9V"><button class="clean-btn toggleButton_wYmb toggleButtonDisabled_vaDU" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_Sxwe"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_Yem1"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_bmvg"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_UyTV"><div class="docsWrapper_XLvK"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_z1FD" type="button"></button><div class="docRoot_HciC"><aside class="theme-doc-sidebar-container docSidebarContainer_e5ai"><div class="sidebarViewport_N8x0"><div class="sidebar_vJCc"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_qiME"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/quickstart">Quickstart Guide</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/resources">Resources</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/docs/category/advanced-topics">Advanced topics</a><button aria-label="Collapse sidebar category &#x27;Advanced topics&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/advanced/lifecycle">Lifecycle</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/advanced/data">Graph data</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/advanced/customization">Customizing appearance</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/advanced/renderers">Renderers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/advanced/coordinate-systems">Coordinate systems</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/advanced/sizes">Node and Edge Sizes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/advanced/layers">Layers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/advanced/events">Events</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/advanced/new-packages">Creating new packages</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/advanced/publish">Publishing new versions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/advanced/migration-v2-v3">Migrating from v2 to v3</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/typedoc-api">Typedoc API</a><button aria-label="Expand sidebar category &#x27;Typedoc API&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_namt"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_YAwJ"><div class="docItemContainer_Rv5Z"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_zCmv" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/advanced-topics"><span itemprop="name">Advanced topics</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Migrating from v2 to v3</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_O_Qc theme-doc-toc-mobile tocMobile_tjDr"><button type="button" class="clean-btn tocCollapsibleButton_htYj">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Migrating from v2 to v3</h1></header><p>This guide will help users migrating their applications from sigma v2.* to v3.*.</p>
<h2 class="anchor anchorWithStickyNavbar_fF9Z" id="exports-endpoints">Exports endpoints<a href="#exports-endpoints" class="hash-link" aria-label="Direct link to Exports endpoints" title="Direct link to Exports endpoints">​</a></h2>
<p>Sigma v3 is built using <a href="https://preconstruct.tools/" target="_blank" rel="noopener noreferrer">Preconstruct</a>, and there are only 5 endpoints now:</p>
<ul>
<li><code>&quot;sigma&quot;</code> exports the main <code>Sigma</code> class, and the other utility classes <code>Camera</code>, <code>MouseCaptor</code> and <code>TouchCaptor</code>;</li>
<li><code>&quot;sigma/rendering&quot;</code> exports everything rendering related, from the programs to the related classes and types;</li>
<li><code>&quot;sigma/settings&quot;</code> exports the <code>Settings</code> interface, the <code>DEFAULT_SETTINGS</code> collection and the <code>validateSettings</code> and <code>resolveSettings</code> utility functions;</li>
<li><code>&quot;sigma/types&quot;</code> exports all remaining sigma specific types (for TypeScript only);</li>
<li><code>&quot;sigma/utils&quot;</code> exports all kind of various utility functions.</li>
</ul>
<p>Also, the <code>node.image</code> program is no more exported from sigma, but must be imported from another dedicated package: <a href="https://www.npmjs.com/package/@sigma/node-image" target="_blank" rel="noopener noreferrer"><code>@sigma/node-image</code></a>.</p>
<h2 class="anchor anchorWithStickyNavbar_fF9Z" id="programs">Programs<a href="#programs" class="hash-link" aria-label="Direct link to Programs" title="Direct link to Programs">​</a></h2>
<p>Sigma v3 has been developed to handle various limitations of sigma v2&#x27;s nodes and edges <strong>programs</strong>. Basically:</p>
<ul>
<li>Programs were very hard to maintain and to develop, with <em>a lot</em> of boilerplate</li>
<li>There were various optimizations we wanted to implement, such as <a href="https://webglfundamentals.org/webgl/lessons/webgl-picking.html" target="_blank" rel="noopener noreferrer"><em>picking</em></a> and <a href="https://webglfundamentals.org/webgl/lessons/webgl-instanced-drawing.html" target="_blank" rel="noopener noreferrer"><em>instanced rendering</em></a>, that would require breaking changes, at the time</li>
<li>Coordinate systems translations where messy and poorly documented, and becoming harder and harder to maintain</li>
</ul>
<p>So, we refined it completely from scratch, to handle all those issues.</p>
<h3 class="anchor anchorWithStickyNavbar_fF9Z" id="existing-programs">Existing programs<a href="#existing-programs" class="hash-link" aria-label="Direct link to Existing programs" title="Direct link to Existing programs">​</a></h3>
<p>Breaking everything in the programs was the opportunity to rename existing program, to better fit what they do:</p>
<ul>
<li><code>edge-fast</code> becomes <code>edge.line</code> (since it uses the <code>WebGLRenderingContext.LINES</code> drawing method)</li>
<li><code>edge</code> becomes <code>edge.rectangle</code> (as edges are rendered as rectangles, using two <code>WebGLRenderingContext.TRIANGLES</code>)</li>
<li><code>node-fast</code> becomes <code>node.point</code> (since it uses <code>WebGLRenderingContext.POINTS</code>)</li>
<li><code>node</code> becomes <code>node.circle</code> (as nodes are rendered as circles, carved inside <code>WebGLRenderingContext.TRIANGLES</code>)</li>
<li><code>node-image</code> becomes <a href="https://www.npmjs.com/package/@sigma/node-image" target="_blank" rel="noopener noreferrer"><code>@sigma/node-image</code></a>, a new satellite package</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_fF9Z" id="new-api">New API<a href="#new-api" class="hash-link" aria-label="Direct link to New API" title="Direct link to New API">​</a></h3>
<p>A <strong>node program</strong> must extend the <a href="https://github.com/jacomyal/sigma.js/blob/main/packages/sigma/src/rendering/node.ts" target="_blank" rel="noopener noreferrer"><strong><code>NodeProgram</code></strong> classe</a>, and an <strong>edge program</strong> must extend the <a href="https://github.com/jacomyal/sigma.js/blob/main/packages/sigma/src/rendering/edge.ts" target="_blank" rel="noopener noreferrer"><strong><code>EdgeProgram</code></strong> classe</a>. Those two classes are designed so that only specific code remains in the programs, without all the boilerplate.</p>
<p><strong>The best to do to understand how to write programs for sigma v3 is to read the existing programs.</strong> The simplest ones are <a href="https://github.com/jacomyal/sigma.js/tree/main/packages/sigma/src/rendering/programs/edge-line" target="_blank" rel="noopener noreferrer"><strong><code>edge.line</code></strong></a> and <a href="https://github.com/jacomyal/sigma.js/tree/main/packages/sigma/src/rendering/programs/node-point" target="_blank" rel="noopener noreferrer"><strong><code>node.point</code></strong></a>.</p>
<p>Some insights, though:</p>
<ul>
<li>To help with TypeScript inference, <strong>uniforms</strong> are generally defined outside the program, and given as generics;</li>
<li>Every programs now have a <code>getDefinition</code> method, that returns various data that help sigma properly initializing the related WebGL program;</li>
<li>Programs also must have a <code>processVisibleItem</code>, that feeds the <code>Float32Array</code> with the data related to a given item;</li>
<li>Finally, programs also provide a <code>setUniforms</code> method, that sets the proper uniform values.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_fF9Z" id="picking">Picking<a href="#picking" class="hash-link" aria-label="Direct link to Picking" title="Direct link to Picking">​</a></h3>
<p>In sigma v3, the collision detection is no more handle with CPU-based computation. The two main issues were:</p>
<ul>
<li>The quad-tree index for nodes was hard to maintain, and only handled disc nodes;</li>
<li>The ad-hoc code that handled edges collisions was slow, and only handled linear edges.</li>
</ul>
<p>The picking work as following:</p>
<ul>
<li>In addition to the visible layers, two more layers are rendered, where each node and edge is drawn with a unique color, that represents its ID;</li>
<li>To know what is at a given pixel, we look at the related picking layer, and if it is a colored pixel, then we instantly know what item it belongs to.</li>
</ul>
<p>There are two main costs, though:</p>
<ul>
<li>Everything is rendered twice;</li>
<li>Every program must handle rendering for <strong>both modes</strong> (&quot;normal&quot; and &quot;picking&quot;).</li>
</ul>
<p>To handle picking within a program, here are the things that must be taken into account:</p>
<ol>
<li>In addition to the color, the ID must also be stored into the data transferred to the CPU. The <code>processVisibleItem</code> receives the ID, properly encoded as a 4 bytes value (as the color), as its first argument.</li>
<li>In the <em>vertex shader</em>, the color given to the <em>fragment shader</em> must be the item color for the normal layer, and the ID for the picking layer. This is done using the <code>PICKING_MODE</code> macro defined constant:</li>
</ol>
<div class="language-glsl codeBlockContainer_ZGJx theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_qZBB"><pre tabindex="0" class="prism-code language-glsl codeBlock_TAPP thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_AdAo"><span class="token-line" style="color:#bfc7d5"><span class="token plain">#ifdef PICKING_MODE</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// For picking mode, we use the ID as the color:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">v_color = a_id;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#else</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// For normal mode, we use the color:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">v_color = a_color;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#endif</span><br></span></code></pre><div class="buttonGroup_TNwR"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_MVhB" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_yxgH"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_QJLJ"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="3">
<li>In the <em>fragment shader</em>, in the picking layer, pixels should either remain uncolored or colored with the given color. There should be no antialiasing. Indeed, if the color is changed, it might become the ID of another item.</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_fF9Z" id="instanced-rendering">Instanced rendering<a href="#instanced-rendering" class="hash-link" aria-label="Direct link to Instanced rendering" title="Direct link to Instanced rendering">​</a></h3>
<p>In sigma v2, there were a lot of repeated data transmitted to the GPU. For instance, to render an edge as a rectangle, all the required data were written <a href="https://github.com/jacomyal/sigma.js/blob/7b3a5ead355f7c54449002e6909a9af2eecae6db/src/rendering/webgl/programs/edge.ts#L166-L193" target="_blank" rel="noopener noreferrer">four times</a>. To fixe this issue, sigma v3 uses <em>instanced rendering</em>. Basically, there are now two different buffers: one that carries data related to each item (node or edge), and another that carries data related to each vertex. Then, the program will handle those buffers to send to the <em>vertex shader</em> both the item related data and the vertex related data.</p>
<p>All programs do not use instanced rendering. For instance, <a href="https://github.com/jacomyal/sigma.js/tree/main/packages/sigma/src/rendering/programs/node-point" target="_blank" rel="noopener noreferrer"><strong><code>node.point</code></strong></a> does need it, since there is only one vertex per node. Basically, every program that use the <code>WebGLRenderingContext.TRIANGLES</code> method should probably use instanced rendering.</p>
<p>So, to use instanced rendering, the <code>getDefinition</code> method of a program must provide a <strong><code>CONSTANT_ATTRIBUTES</code></strong> array, shaped as the <code>ATTRIBUTES</code> array, but with attributes that are related to each vertex, and a <strong><code>CONSTANT_DATA</code></strong> that stores an array of data for each vertex. The simplest program that uses instanced rendering might be <a href="https://github.com/jacomyal/sigma.js/tree/main/packages/sigma/src/rendering/programs/node-circle" target="_blank" rel="noopener noreferrer"><strong><code>node.circle</code></strong></a>. <strong>It is certainly a good program to read to better understand how to write a program using instanced rendering</strong>.</p>
<h3 class="anchor anchorWithStickyNavbar_fF9Z" id="canvas-labels-and-hovered-nodes-rendering">Canvas labels and hovered nodes rendering<a href="#canvas-labels-and-hovered-nodes-rendering" class="hash-link" aria-label="Direct link to Canvas labels and hovered nodes rendering" title="Direct link to Canvas labels and hovered nodes rendering">​</a></h3>
<p>Finally, the way sigma handles canvas renderers for nodes and edges labels and hovered nodes have been updated:</p>
<ul>
<li>Each program class can provide its own canvas renderers (an optional <code>drawLabel</code> method, and an additional optional <code>drawHover</code> only for node renderers). This allows programs that render different shapes to have custom labels rendering (such as <a href="https://www.npmjs.com/package/@sigma/edge-curve" target="_blank" rel="noopener noreferrer"><code>@sigma/edge-curve</code></a> for instance).</li>
<li>Programs that do not provide their own <code>drawLabel</code> or <code>drawHover</code> methods rely on the <code>defaultDrawEdgeLabel</code>, <code>defaultDrawNodeLabel</code> and <code>defaultDrawNodeHover</code> settings. This allows overriding canvas renderers for all &quot;classic&quot; programs (ie. circle nodes and straight edges) all at once.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_fF9Z" id="other-breaking-changes">Other breaking changes<a href="#other-breaking-changes" class="hash-link" aria-label="Direct link to Other breaking changes" title="Direct link to Other breaking changes">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_fF9Z" id="typescript-generics">TypeScript generics<a href="#typescript-generics" class="hash-link" aria-label="Direct link to TypeScript generics" title="Direct link to TypeScript generics">​</a></h3>
<p>In sigma v3, the <code>Sigma</code> class accepts the same generics as its carried <code>Graph</code> instance. This helps to have reducers or other helpers written with the proper node and/or edge attributes.</p>
<h3 class="anchor anchorWithStickyNavbar_fF9Z" id="settings">Settings<a href="#settings" class="hash-link" aria-label="Direct link to Settings" title="Direct link to Settings">​</a></h3>
<p>Some settings have been updated:</p>
<ul>
<li><code>enableEdgeClickEvents</code>, <code>enableEdgeWheelEvents</code> and <code>enableEdgeHoverEvents</code> disappear and are all replaced by the single <strong><code>enableEdgeEvents</code></strong> setting;</li>
<li><code>labelRenderer</code>, <code>hoverRenderer</code> and <code>edgeLabelRenderer</code> disappear and are respectively replaced by <strong><code>defaultDrawNodeLabel</code></strong>, <strong><code>defaultDrawNodeHover</code></strong> and <strong><code>defaultDrawEdgeLabel</code></strong>;</li>
<li><strong><code>zoomToSizeRatioFunction</code></strong> and <strong><code>itemSizesReference</code></strong> are added to handle cases where nodes grow linearly with the zoom and all items sizes and positions are in the same coordinates system.</li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/jacomyal/sigma.js/tree/main/packages/website/docs/advanced/migration-v2-v3.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_UohW" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_g62E"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/advanced/publish"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Publishing new versions</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/category/typedoc-api"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Typedoc API</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_TN1Q thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#exports-endpoints" class="table-of-contents__link toc-highlight">Exports endpoints</a></li><li><a href="#programs" class="table-of-contents__link toc-highlight">Programs</a><ul><li><a href="#existing-programs" class="table-of-contents__link toc-highlight">Existing programs</a></li><li><a href="#new-api" class="table-of-contents__link toc-highlight">New API</a></li><li><a href="#picking" class="table-of-contents__link toc-highlight">Picking</a></li><li><a href="#instanced-rendering" class="table-of-contents__link toc-highlight">Instanced rendering</a></li><li><a href="#canvas-labels-and-hovered-nodes-rendering" class="table-of-contents__link toc-highlight">Canvas labels and hovered nodes rendering</a></li></ul></li><li><a href="#other-breaking-changes" class="table-of-contents__link toc-highlight">Other breaking changes</a><ul><li><a href="#typescript-generics" class="table-of-contents__link toc-highlight">TypeScript generics</a></li><li><a href="#settings" class="table-of-contents__link toc-highlight">Settings</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer"><div class="container container-fluid"><div class="row"><div class="footer__col col"><p><a href="/" class="with-logo"><img src="/img/logo-sigma-ruby.svg" alt=""> <strong class="text-ruby">sigma</strong><strong class="text-grey">.js</strong></a> <!-- -->is published by <a href="https://medialab.sciencespo.fr/en/">Sciences-Po médialab</a> and<!-- --> <a href="https://ouestware.com/en">OuestWare</a>.</p><ul><li><a href="/docs">documentation</a></li><li><a href="https://github.com/jacomyal/sigma.js">github.com/jacomyal/sigma.js</a></li><li><a rel="me" href="https://vis.social/@sigmajs">vis.social/@sigmajs (Mastodon)</a></li></ul></div><div class="footer__col col"><p>It is developed under<!-- --> <a href="https://github.com/jacomyal/sigma.js/blob/main/LICENSE.txt">the MIT License</a>.</p><p>This website uses <a href="https://themeui.net/hauora-sans-free-font/">Hauroa Sans</a>,<!-- --> <a href="https://public-sans.digital.gov/">Public Sans</a> and<!-- --> <a href="https://github.com/microsoft/cascadia-code">Cascadia Code</a> fonts.</p></div></div></div></footer></div>
</body>
</html>