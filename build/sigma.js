!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.Sigma=e():t.Sigma=e()}(window,(function(){return function(t){var e={};function r(i){if(e[i])return e[i].exports;var n=e[i]={i:i,l:!1,exports:{}};return t[i].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=t,r.c=e,r.d=function(t,e,i){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)r.d(i,n,function(e){return t[e]}.bind(null,n));return i},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=15)}([function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.canUse32BitsIndices=e.extractPixel=e.matrixFromCamera=e.floatColor=void 0;var i=r(26),n={},o=new Int8Array(4),a=new Int32Array(o.buffer,0,1),s=new Float32Array(o.buffer,0,1),c=/^\s*rgba?\s*\(/,l=/^\s*rgba?\s*\(\s*([0-9]*)\s*,\s*([0-9]*)\s*,\s*([0-9]*)(?:\s*,\s*(.*)?)?\)\s*$/;e.floatColor=function(t){if(void 0!==n[t])return n[t];var e=0,r=0,i=0,o=1;if("#"===t[0])4===t.length?(e=parseInt(t.charAt(1)+t.charAt(1),16),r=parseInt(t.charAt(2)+t.charAt(2),16),i=parseInt(t.charAt(3)+t.charAt(3),16)):(e=parseInt(t.charAt(1)+t.charAt(2),16),r=parseInt(t.charAt(3)+t.charAt(4),16),i=parseInt(t.charAt(5)+t.charAt(6),16));else if(c.test(t)){var h=t.match(l);null!==h&&(e=+h[1],r=+h[2],i=+h[3],h[4]&&(o=+h[4]))}var u=4278190079&((o=255*o|0)<<24|i<<16|r<<8|e);a[0]=u;var d=s[0];return n[t]=d,d},e.matrixFromCamera=function(t,e){var r=t.angle,n=t.ratio,o=t.x,a=t.y,s=e.width,c=e.height,l=i.identity(),h=Math.min(s,c),u=i.translate(i.identity(),-o,-a),d=i.scale(i.identity(),1/n),f=i.rotate(i.identity(),-r),p=i.scale(i.identity(),h/s*2,h/c*2);return i.multiply(l,p),i.multiply(l,f),i.multiply(l,d),i.multiply(l,u),l},e.extractPixel=function(t,e,r,i){var n=i||new Uint8Array(4);return t.readPixels(e,r,1,1,t.RGBA,t.UNSIGNED_BYTE,n),n},e.canUse32BitsIndices=function(t){return"undefined"!=typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext||!!t.getExtension("OES_element_index_uint")}},function(t,e,r){"use strict";var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=r(3),s=r(16),c=o(r(6)),l=r(4),h=function(t){function e(){var e=t.call(this)||this;return e.x=.5,e.y=.5,e.angle=0,e.ratio=1,e.nextFrame=null,e.enabled=!0,e.previousState=e.getState(),e}return n(e,t),e.prototype.enable=function(){return this.enabled=!0,this},e.prototype.disable=function(){return this.enabled=!1,this},e.prototype.getState=function(){return{x:this.x,y:this.y,angle:this.angle,ratio:this.ratio}},e.prototype.getPreviousState=function(){var t=this.previousState;return{x:t.x,y:t.y,angle:t.angle,ratio:t.ratio}},e.prototype.isAnimated=function(){return!!this.nextFrame},e.prototype.graphToViewport=function(t,e,r){var i=Math.min(t.width,t.height),n=i/t.width,o=i/t.height;return{x:(e-this.x+this.ratio/2/n)*(i/this.ratio),y:(this.y-r+this.ratio/2/o)*(i/this.ratio)}},e.prototype.viewportToGraph=function(t,e,r){var i=Math.min(t.width,t.height),n=i/t.width,o=i/t.height;return{x:this.ratio/i*e+this.x-this.ratio/2/n,y:-(this.ratio/i*r-this.y-this.ratio/2/o)}},e.prototype.viewRectangle=function(t){var e=0*t.width/8,r=0*t.height/8,i=this.viewportToGraph(t,0-e,0-r),n=this.viewportToGraph(t,t.width+e,0-r),o=this.viewportToGraph(t,0,t.height+r);return{x1:i.x,y1:i.y,x2:n.x,y2:n.y,height:n.y-o.y}},e.prototype.setState=function(t){return this.enabled?(this.previousState=this.getState(),t.x&&(this.x=t.x),t.y&&(this.y=t.y),t.angle&&(this.angle=t.angle),t.ratio&&(this.ratio=t.ratio),this.emit("updated",this.getState()),this):this},e.prototype.animate=function(t,e,r){var i=this;if(!this.enabled)return this;var n=l.assign({},s.ANIMATE_DEFAULTS,e),o="function"==typeof n.easing?n.easing:c.default[n.easing];this.nextFrame&&cancelAnimationFrame(this.nextFrame);var a=Date.now(),h=this.getState(),u=function(){var e=(Date.now()-a)/n.duration;if(e>=1)return i.nextFrame=null,i.setState(t),void("function"==typeof r&&r());var s=o(e),c={};t.x&&(c.x=h.x+(t.x-h.x)*s),t.y&&(c.y=h.y+(t.y-h.y)*s),t.angle&&(c.angle=h.angle+(t.angle-h.angle)*s),t.ratio&&(c.ratio=h.ratio+(t.ratio-h.ratio)*s),i.setState(c),i.nextFrame=requestAnimationFrame(u)};this.nextFrame?(cancelAnimationFrame(this.nextFrame),this.nextFrame=requestAnimationFrame(u)):u()},e.prototype.animatedZoom=function(t){return t?"number"==typeof t?this.animate({ratio:this.ratio/t}):this.animate({ratio:this.ratio/(t.factor||1.5)},t):this.animate({ratio:this.ratio/1.5})},e.prototype.animatedUnzoom=function(t){return t?"number"==typeof t?this.animate({ratio:this.ratio*t}):this.animate({ratio:this.ratio*(t.factor||1.5)},t):this.animate({ratio:1.5*this.ratio})},e.prototype.animatedReset=function(t){return this.animate({x:.5,y:.5,ratio:1,angle:0},t)},e}(a.EventEmitter);e.default=h},function(t,e,r){"use strict";var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.createEdgeCompoundProgram=e.AbstractEdgeProgram=void 0;var o=function(t){function e(e,r,i,n,o){var a=t.call(this,e,r,i,n,o)||this;a.positionLocation=e.getAttribLocation(a.program,"a_position"),a.colorLocation=e.getAttribLocation(a.program,"a_color");var s=e.getUniformLocation(a.program,"u_resolution");if(null===s)throw new Error("sigma/renderers/webgl/program/common/edge: error while getting resolutionLocation");a.resolutionLocation=s;var c=e.getUniformLocation(a.program,"u_matrix");if(null===c)throw new Error("sigma/renderers/webgl/program/common/edge: error while getting matrixLocation");return a.matrixLocation=c,a}return n(e,t),e.prototype.bind=function(){var t=this.gl;t.enableVertexAttribArray(this.positionLocation),t.enableVertexAttribArray(this.colorLocation),t.vertexAttribPointer(this.positionLocation,2,t.FLOAT,!1,this.attributes*Float32Array.BYTES_PER_ELEMENT,0),t.vertexAttribPointer(this.colorLocation,1,t.FLOAT,!1,this.attributes*Float32Array.BYTES_PER_ELEMENT,8)},e}(r(13).AbstractProgram);e.AbstractEdgeProgram=o,e.createEdgeCompoundProgram=function(t){return function(){function e(e){this.programs=t.map((function(t){return new t(e)}))}return e.prototype.bufferData=function(){this.programs.forEach((function(t){return t.bufferData()}))},e.prototype.allocate=function(t){this.programs.forEach((function(e){return e.allocate(t)}))},e.prototype.bind=function(){},e.prototype.computeIndices=function(){this.programs.forEach((function(t){return t.computeIndices()}))},e.prototype.render=function(t){this.programs.forEach((function(e){return e.render(t)}))},e.prototype.process=function(t,e,r,i){this.programs.forEach((function(n){return n.process(t,e,r,i)}))},e}()}},function(t,e,r){"use strict";var i,n="object"==typeof Reflect?Reflect:null,o=n&&"function"==typeof n.apply?n.apply:function(t,e,r){return Function.prototype.apply.call(t,e,r)};i=n&&"function"==typeof n.ownKeys?n.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)};var a=Number.isNaN||function(t){return t!=t};function s(){s.init.call(this)}t.exports=s,s.EventEmitter=s,s.prototype._events=void 0,s.prototype._eventsCount=0,s.prototype._maxListeners=void 0;var c=10;function l(t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}function h(t){return void 0===t._maxListeners?s.defaultMaxListeners:t._maxListeners}function u(t,e,r,i){var n,o,a,s;if(l(r),void 0===(o=t._events)?(o=t._events=Object.create(null),t._eventsCount=0):(void 0!==o.newListener&&(t.emit("newListener",e,r.listener?r.listener:r),o=t._events),a=o[e]),void 0===a)a=o[e]=r,++t._eventsCount;else if("function"==typeof a?a=o[e]=i?[r,a]:[a,r]:i?a.unshift(r):a.push(r),(n=h(t))>0&&a.length>n&&!a.warned){a.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=t,c.type=e,c.count=a.length,s=c,console&&console.warn&&console.warn(s)}return t}function d(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function f(t,e,r){var i={fired:!1,wrapFn:void 0,target:t,type:e,listener:r},n=d.bind(i);return n.listener=r,i.wrapFn=n,n}function p(t,e,r){var i=t._events;if(void 0===i)return[];var n=i[e];return void 0===n?[]:"function"==typeof n?r?[n.listener||n]:[n]:r?function(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}(n):m(n,n.length)}function g(t){var e=this._events;if(void 0!==e){var r=e[t];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function m(t,e){for(var r=new Array(e),i=0;i<e;++i)r[i]=t[i];return r}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return c},set:function(t){if("number"!=typeof t||t<0||a(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");c=t}}),s.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||a(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},s.prototype.getMaxListeners=function(){return h(this)},s.prototype.emit=function(t){for(var e=[],r=1;r<arguments.length;r++)e.push(arguments[r]);var i="error"===t,n=this._events;if(void 0!==n)i=i&&void 0===n.error;else if(!i)return!1;if(i){var a;if(e.length>0&&(a=e[0]),a instanceof Error)throw a;var s=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw s.context=a,s}var c=n[t];if(void 0===c)return!1;if("function"==typeof c)o(c,this,e);else{var l=c.length,h=m(c,l);for(r=0;r<l;++r)o(h[r],this,e)}return!0},s.prototype.addListener=function(t,e){return u(this,t,e,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(t,e){return u(this,t,e,!0)},s.prototype.once=function(t,e){return l(e),this.on(t,f(this,t,e)),this},s.prototype.prependOnceListener=function(t,e){return l(e),this.prependListener(t,f(this,t,e)),this},s.prototype.removeListener=function(t,e){var r,i,n,o,a;if(l(e),void 0===(i=this._events))return this;if(void 0===(r=i[t]))return this;if(r===e||r.listener===e)0==--this._eventsCount?this._events=Object.create(null):(delete i[t],i.removeListener&&this.emit("removeListener",t,r.listener||e));else if("function"!=typeof r){for(n=-1,o=r.length-1;o>=0;o--)if(r[o]===e||r[o].listener===e){a=r[o].listener,n=o;break}if(n<0)return this;0===n?r.shift():function(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}(r,n),1===r.length&&(i[t]=r[0]),void 0!==i.removeListener&&this.emit("removeListener",t,a||e)}return this},s.prototype.off=s.prototype.removeListener,s.prototype.removeAllListeners=function(t){var e,r,i;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[t]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[t]),this;if(0===arguments.length){var n,o=Object.keys(r);for(i=0;i<o.length;++i)"removeListener"!==(n=o[i])&&this.removeAllListeners(n);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(e=r[t]))this.removeListener(t,e);else if(void 0!==e)for(i=e.length-1;i>=0;i--)this.removeListener(t,e[i]);return this},s.prototype.listeners=function(t){return p(this,t,!0)},s.prototype.rawListeners=function(t){return p(this,t,!1)},s.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):g.call(t,e)},s.prototype.listenerCount=g,s.prototype.eventNames=function(){return this._eventsCount>0?i(this._events):[]}},function(t,e,r){"use strict";function i(t){return"object"==typeof t&&null!==t&&t.constructor===Object}Object.defineProperty(e,"__esModule",{value:!0}),e.assign=e.isPlainObject=void 0,e.isPlainObject=i,e.assign=function t(e){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];e=e||{};for(var o=0,a=r.length;o<a;o++){var s=r[o];if(s)for(var c in s)i(s[c])?e[c]=t(e[c],s[c]):e[c]=s[c]}return e}},function(t,e,r){"use strict";var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e}(r(3).EventEmitter);e.default=o},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.cubicInOut=e.cubicOut=e.cubicIn=e.quadraticInOut=e.quadraticOut=e.quadraticIn=e.linear=void 0,e.linear=function(t){return t},e.quadraticIn=function(t){return t*t},e.quadraticOut=function(t){return t*(2-t)},e.quadraticInOut=function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)},e.cubicIn=function(t){return t*t*t},e.cubicOut=function(t){return--t*t*t+1},e.cubicInOut=function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)};var i={linear:e.linear,quadraticIn:e.quadraticIn,quadraticOut:e.quadraticOut,quadraticInOut:e.quadraticInOut,cubicIn:e.cubicIn,cubicOut:e.cubicOut,cubicInOut:e.cubicInOut};e.default=i},function(t,e,r){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var n=i(r(17));function o(t,e,r,i,n,o,a){return t<i+o&&t+r>i&&e<n+a&&e+r>n}function a(t,e,r,i,n,o,a,s){return t<n+a&&t+r>n&&e<o+s&&e+i>o}function s(t,e,r,i,n,o){var a=t<r+n/2;return e<i+o/2?a?1:2:a?3:4}var c=function(){function t(t){void 0===t&&(t={}),this.containers={},this.cache=null,this.lastRectangle=null;var e=Math.pow(4,5);this.data=new Float32Array((4*e-1)/3*4),t.boundaries?this.resize(t.boundaries):this.resize({x:0,y:0,width:1,height:1}),"function"==typeof t.filter&&(this.nodeFilter=t.filter)}return t.prototype.add=function(t,e,r,i){return function(t,e,r,i,n,a,s){for(var c=n-s,l=a-s,h=2*s,u=0,d=0;;){if(u>=t)return r[d]=r[d]||[],void r[d].push(i);var f=4*d+4,p=4*d+8,g=4*d+12,m=4*d+16,v=o(c,l,h,e[f+0],e[f+1],e[f+2],e[f+3]),y=o(c,l,h,e[p+0],e[p+1],e[p+2],e[p+3]),_=o(c,l,h,e[g+0],e[g+1],e[g+2],e[g+3]),b=o(c,l,h,e[m+0],e[m+1],e[m+2],e[m+3]),w=[v,y,_,b].reduce((function(t,e){return e?t+1:t}),0);if(0===w)throw new Error("sigma/quadtree.insertNode: no collision (level: "+u+", key: "+i+", x: "+n+", y: "+a+", size: "+s+").");if(3===w)throw new Error("sigma/quadtree.insertNode: 3 impossible collisions (level: "+u+", key: "+i+", x: "+n+", y: "+a+", size: "+s+").");if(w>1)return r[d]=r[d]||[],void r[d].push(i);u++,v&&(d=f),y&&(d=p),_&&(d=g),b&&(d=m)}}(5,this.data,this.containers,t,e,r,i),this},t.prototype.resize=function(t){this.clear(),this.data[0]=t.x,this.data[1]=t.y,this.data[2]=t.width,this.data[3]=t.height,function(t,e){for(var r=[0,0];r.length;){var i=r.pop(),n=r.pop(),o=4*n+4,a=4*n+8,s=4*n+12,c=4*n+16,l=e[n+0],h=e[n+1],u=e[n+2]/2,d=e[n+3]/2;e[o+0]=l,e[o+1]=h,e[o+2]=u,e[o+3]=d,e[a+0]=l+u,e[a+1]=h,e[a+2]=u,e[a+3]=d,e[s+0]=l,e[s+1]=h+d,e[s+2]=u,e[s+3]=d,e[c+0]=l+u,e[c+1]=h+d,e[c+2]=u,e[c+3]=d,i<t-1&&(r.push(c,i+1),r.push(s,i+1),r.push(a,i+1),r.push(o,i+1))}}(5,this.data)},t.prototype.clear=function(){return this.containers={},this},t.prototype.point=function(t,e){var r=[],i=0,n=0;do{this.containers[i]&&r.push.apply(r,this.containers[i]),i=4*i+4*s(t,e,this.data[i+0],this.data[i+1],this.data[i+2],this.data[i+3]),n++}while(n<=5);return r},t.prototype.rectangle=function(t,e,r,i,o){var s=this.lastRectangle;if(s&&t===s.x1&&r===s.x2&&e===s.y1&&i===s.y2&&o===s.height)return this.cache;if(this.lastRectangle={x1:t,y1:e,x2:r,y2:i,height:o},!function(t,e,r,i){return t===r||e===i}(t,e,r,i))throw new Error("sigma/quadtree.rectangle: shifted view is not yet implemented.");var c=function(t,e,r,i,o,s,c){for(var l,h=[0,0],u=[];h.length;){var d=h.pop(),f=h.pop();if(d&&f){if((l=r[f])&&n.default(u,l),d>=t)continue;var p=4*f+4,g=4*f+8,m=4*f+12,v=4*f+16,y=a(i,o,s,c,e[p+0],e[p+1],e[p+2],e[p+3]),_=a(i,o,s,c,e[g+0],e[g+1],e[g+2],e[g+3]),b=a(i,o,s,c,e[m+0],e[m+1],e[m+2],e[m+3]),w=a(i,o,s,c,e[v+0],e[v+1],e[v+2],e[v+3]);y&&h.push(p,d+1),_&&h.push(g,d+1),b&&h.push(m,d+1),w&&h.push(v,d+1)}}return u}(5,this.data,this.containers,t,e,Math.abs(t-r)||Math.abs(e-i),o);return this.cache=c,this.cache},t}();e.default=c},function(t,e,r){"use strict";(function(t){var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=o(r(1)),s=o(r(21)),c=r(22),l=function(e){function r(t,r){var i=e.call(this,t,r)||this;return i.enabled=!0,i.hasDragged=!1,i.downStartTime=null,i.lastMouseX=0,i.lastMouseY=0,i.isMouseDown=!1,i.isMoving=!1,i.movingTimeout=null,i.startCameraState=null,i.lastCameraState=null,i.clicks=0,i.doubleClickTimeout=null,i.wheelLock=!1,i.handleClick=i.handleClick.bind(i),i.handleRightClick=i.handleRightClick.bind(i),i.handleDown=i.handleDown.bind(i),i.handleUp=i.handleUp.bind(i),i.handleMove=i.handleMove.bind(i),i.handleWheel=i.handleWheel.bind(i),i.handleOut=i.handleOut.bind(i),t.addEventListener("click",i.handleClick,!1),t.addEventListener("contextmenu",i.handleRightClick,!1),t.addEventListener("mousedown",i.handleDown,!1),t.addEventListener("mousemove",i.handleMove,!1),t.addEventListener("wheel",i.handleWheel,!1),t.addEventListener("mouseout",i.handleOut,!1),document.addEventListener("mouseup",i.handleUp,!1),i}return n(r,e),r.prototype.kill=function(){var t=this.container;t.removeEventListener("click",this.handleClick),t.removeEventListener("contextmenu",this.handleRightClick),t.removeEventListener("mousedown",this.handleDown),t.removeEventListener("mousemove",this.handleMove),t.removeEventListener("wheel",this.handleWheel),t.removeEventListener("mouseout",this.handleOut),document.removeEventListener("mouseup",this.handleUp)},r.prototype.handleClick=function(t){var e=this;if(this.enabled){if(this.clicks++,2===this.clicks)return this.clicks=0,null!==this.doubleClickTimeout&&(clearTimeout(this.doubleClickTimeout),this.doubleClickTimeout=null),this.handleDoubleClick(t);setTimeout((function(){e.clicks=0,e.doubleClickTimeout=null}),300),this.hasDragged||this.emit("click",c.getMouseCoords(t))}},r.prototype.handleRightClick=function(t){this.enabled&&this.emit("rightClick",c.getMouseCoords(t))},r.prototype.handleDoubleClick=function(t){if(this.enabled){var e=c.getCenter(t),r=this.camera.getState(),i=r.ratio/2.2,n={width:this.container.offsetWidth,height:this.container.offsetHeight},o=c.getX(t),s=c.getY(t),l=new a.default;l.ratio=i,l.x=r.x,l.y=r.y;var h=this.camera.viewportToGraph(n,o,s),u=this.camera.viewportToGraph(n,e.x,e.y),d=l.viewportToGraph(n,o,s),f=l.viewportToGraph(n,e.x,e.y),p=d.x-f.x-h.x+u.x,g=d.y-f.y-h.y+u.y;return this.camera.animate({x:r.x-p,y:r.y-g,ratio:i},{easing:"quadraticInOut",duration:200}),t.preventDefault?t.preventDefault():t.returnValue=!1,t.stopPropagation(),!1}},r.prototype.handleDown=function(t){this.enabled&&(this.startCameraState=this.camera.getState(),this.lastCameraState=this.startCameraState,this.lastMouseX=c.getX(t),this.lastMouseY=c.getY(t),this.hasDragged=!1,this.downStartTime=Date.now(),t.which,this.isMouseDown=!0,this.emit("mousedown",c.getMouseCoords(t)))},r.prototype.handleUp=function(e){var r=this;if(this.enabled&&this.isMouseDown){this.isMouseDown=!1,null!==this.movingTimeout&&(clearTimeout(this.movingTimeout),this.movingTimeout=null);var i=c.getX(e),n=c.getY(e),o=this.camera.getState(),a=this.camera.getPreviousState();this.isMoving?this.camera.animate({x:o.x+3*(o.x-a.x),y:o.y+3*(o.y-a.y)},{duration:200,easing:"quadraticOut"}):this.lastMouseX===i&&this.lastMouseY===n||this.camera.setState({x:o.x,y:o.y}),this.isMoving=!1,t((function(){return r.hasDragged=!1})),this.emit("mouseup",c.getMouseCoords(e))}},r.prototype.handleMove=function(t){var e=this;if(this.enabled){if(this.emit("mousemove",c.getMouseCoords(t)),this.isMouseDown){this.isMoving=!0,this.hasDragged=!0,null!==this.movingTimeout&&clearTimeout(this.movingTimeout),this.movingTimeout=window.setTimeout((function(){e.movingTimeout=null,e.isMoving=!1}),200);var r={width:this.container.offsetWidth,height:this.container.offsetHeight},i=c.getX(t),n=c.getY(t),o=this.camera.viewportToGraph(r,this.lastMouseX,this.lastMouseY),a=this.camera.viewportToGraph(r,i,n),s=o.x-a.x,l=o.y-a.y,h=this.camera.getState(),u=h.x+s,d=h.y+l;this.camera.setState({x:u,y:d}),this.lastMouseX=i,this.lastMouseY=n}return t.preventDefault?t.preventDefault():t.returnValue=!1,t.stopPropagation(),!1}},r.prototype.handleWheel=function(t){var e=this;if(t.preventDefault?t.preventDefault():t.returnValue=!1,t.stopPropagation(),!this.enabled)return!1;var r=c.getWheelDelta(t);if(!r)return!1;if(this.wheelLock)return!1;this.wheelLock=!0;var i=r>0?1/1.7:1.7,n=this.camera.getState(),o=i*n.ratio,s=c.getCenter(t),l={width:this.container.offsetWidth,height:this.container.offsetHeight},h=c.getX(t),u=c.getY(t),d=new a.default;d.ratio=o,d.x=n.x,d.y=n.y;var f=this.camera.viewportToGraph(l,h,u),p=this.camera.viewportToGraph(l,s.x,s.y),g=d.viewportToGraph(l,h,u),m=d.viewportToGraph(l,s.x,s.y),v=g.x-m.x-f.x+p.x,y=g.y-m.y-f.y+p.y;return this.camera.animate({x:n.x-v,y:n.y-y,ratio:o},{easing:"linear",duration:200},(function(){return e.wheelLock=!1})),!1},r.prototype.handleOut=function(){},r}(s.default);e.default=l}).call(this,r(18).setImmediate)},function(t,e){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(t){"object"==typeof window&&(r=window)}t.exports=r},function(t,e,r){"use strict";var i=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var i,n,o=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(i=o.next()).done;)a.push(i.value)}catch(t){n={error:t}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return a};Object.defineProperty(e,"__esModule",{value:!0}),e.createNormalizationFunction=e.getPixelRatio=e.createElement=void 0,e.createElement=function(t,e){var r=document.createElement(t);return Object.keys(e).forEach((function(t){if("style"===t){var i=e[t];r.setAttribute("style",Object.keys(i).map((function(t){return t+": "+i[t]})).join(";"))}else r.setAttribute(t,e[t])})),r},e.getPixelRatio=function(){return void 0!==window.devicePixelRatio?window.devicePixelRatio:1},e.createNormalizationFunction=function(t){var e=i(t.x,2),r=e[0],n=e[1],o=i(t.y,2),a=o[0],s=o[1],c=Math.max(n-r,s-a);0===c&&(c=1);var l=(n+r)/2,h=(s+a)/2,u=function(t){return{x:.5+(t.x-l)/c,y:.5+(t.y-h)/c}};return u.applyTo=function(t){t.x=.5+(t.x-l)/c,t.y=.5+(t.y-h)/c},u.inverse=function(t){return{x:l+c*(t.x-.5),y:h+c*(t.y-.5)}},u.ratio=c,u}},function(t,e){t.exports=function(t){return null!==t&&"object"==typeof t&&"function"==typeof t.addUndirectedEdgeWithKey&&"function"==typeof t.dropNode&&"boolean"==typeof t.multi}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e,r){var i=r.labelSize,n=r.labelFont,o=r.labelWeight;t.fillStyle=e.color,t.font=o+" "+i+"px "+n,t.fillText(e.label,e.x+e.size+3,e.y+i/3)}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AbstractProgram=void 0;var i=r(35),n=function(){function t(t,e,r,n,o){this.array=new Float32Array,this.points=n,this.attributes=o,this.gl=t,this.vertexShaderSource=e,this.fragmentShaderSource=r;var a=t.createBuffer();if(null===a)throw new Error("sigma/renderers/webgl/program/program.Program: error while creating the buffer");this.buffer=a,t.bindBuffer(t.ARRAY_BUFFER,this.buffer),this.vertexShader=i.loadVertexShader(t,this.vertexShaderSource),this.fragmentShader=i.loadFragmentShader(t,this.fragmentShaderSource),this.program=i.loadProgram(t,[this.vertexShader,this.fragmentShader])}return t.prototype.bufferData=function(){var t=this.gl;t.bufferData(t.ARRAY_BUFFER,this.array,t.DYNAMIC_DRAW)},t.prototype.allocate=function(t){this.array=new Float32Array(this.points*this.attributes*t)},t}();e.AbstractProgram=n},function(t,e,r){"use strict";r.r(e),e.default="precision mediump float;\n\nvarying vec4 v_color;\nvarying vec2 v_normal;\nvarying float v_thickness;\n\nconst float feather = 2.6;\nconst vec4 color0 = vec4(0.0, 0.0, 0.0, 0.0);\n\nvoid main(void) {\n  float dist = length(v_normal) * v_thickness;\n\n  float t = smoothstep(\n    v_thickness - feather,\n    v_thickness,\n    dist\n  );\n\n  gl_FragColor = mix(v_color, color0, t);\n}\n"},function(t,e,r){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.WebGLRenderer=e.MouseCaptor=e.QuadTree=e.Camera=e.Renderer=void 0;var n=i(r(5));e.Renderer=n.default;var o=i(r(1));e.Camera=o.default;var a=i(r(7));e.QuadTree=a.default;var s=i(r(8));e.MouseCaptor=s.default;var c=i(r(23));e.WebGLRenderer=c.default},function(t,e,r){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.animateNodes=e.ANIMATE_DEFAULTS=void 0;var n=r(4),o=i(r(6));e.ANIMATE_DEFAULTS={easing:"quadraticInOut",duration:150},e.animateNodes=function(t,r,i,a){var s=n.assign({},e.ANIMATE_DEFAULTS,i),c="function"==typeof s.easing?s.easing:o.default[s.easing],l=Date.now(),h={};Object.keys(r).forEach((function(e){var i=r[e];h[e]={},Object.keys(i).forEach((function(r){var i=t.getNodeAttribute(e,r);h[e][r]=i}))}));var u=null,d=function(){var e=(Date.now()-l)/s.duration;if(e>=1)return Object.keys(r).forEach((function(e){var i=r[e];Object.keys(i).forEach((function(r){var n=i[r];t.setNodeAttribute(e,r,n)}))})),void("function"==typeof a&&a());e=c(e),Object.keys(r).forEach((function(i){var n=r[i],o=h[i];Object.keys(n).forEach((function(r){var a=n[r];t.setNodeAttribute(i,r,a*e+o[r]*(1-e))}))})),u=requestAnimationFrame(d)};return d(),function(){u&&cancelAnimationFrame(u)}}},function(t,e){t.exports=function(t,e){var r=e.length;if(0!==r){var i=t.length;t.length+=r;for(var n=0;n<r;n++)t[i+n]=e[n]}}},function(t,e,r){(function(t){var i=void 0!==t&&t||"undefined"!=typeof self&&self||window,n=Function.prototype.apply;function o(t,e){this._id=t,this._clearFn=e}e.setTimeout=function(){return new o(n.call(setTimeout,i,arguments),clearTimeout)},e.setInterval=function(){return new o(n.call(setInterval,i,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},o.prototype.unref=o.prototype.ref=function(){},o.prototype.close=function(){this._clearFn.call(i,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout((function(){t._onTimeout&&t._onTimeout()}),e))},r(19),e.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==t&&t.setImmediate||this&&this.setImmediate,e.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==t&&t.clearImmediate||this&&this.clearImmediate}).call(this,r(9))},function(t,e,r){(function(t,e){!function(t,r){"use strict";if(!t.setImmediate){var i,n,o,a,s,c=1,l={},h=!1,u=t.document,d=Object.getPrototypeOf&&Object.getPrototypeOf(t);d=d&&d.setTimeout?d:t,"[object process]"==={}.toString.call(t.process)?i=function(t){e.nextTick((function(){p(t)}))}:!function(){if(t.postMessage&&!t.importScripts){var e=!0,r=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=r,e}}()?t.MessageChannel?((o=new MessageChannel).port1.onmessage=function(t){p(t.data)},i=function(t){o.port2.postMessage(t)}):u&&"onreadystatechange"in u.createElement("script")?(n=u.documentElement,i=function(t){var e=u.createElement("script");e.onreadystatechange=function(){p(t),e.onreadystatechange=null,n.removeChild(e),e=null},n.appendChild(e)}):i=function(t){setTimeout(p,0,t)}:(a="setImmediate$"+Math.random()+"$",s=function(e){e.source===t&&"string"==typeof e.data&&0===e.data.indexOf(a)&&p(+e.data.slice(a.length))},t.addEventListener?t.addEventListener("message",s,!1):t.attachEvent("onmessage",s),i=function(e){t.postMessage(a+e,"*")}),d.setImmediate=function(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),r=0;r<e.length;r++)e[r]=arguments[r+1];var n={callback:t,args:e};return l[c]=n,i(c),c++},d.clearImmediate=f}function f(t){delete l[t]}function p(t){if(h)setTimeout(p,0,t);else{var e=l[t];if(e){h=!0;try{!function(t){var e=t.callback,r=t.args;switch(r.length){case 0:e();break;case 1:e(r[0]);break;case 2:e(r[0],r[1]);break;case 3:e(r[0],r[1],r[2]);break;default:e.apply(void 0,r)}}(e)}finally{f(t),h=!1}}}}}("undefined"==typeof self?void 0===t?this:t:self)}).call(this,r(9),r(20))},function(t,e){var r,i,n=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(t){if(r===setTimeout)return setTimeout(t,0);if((r===o||!r)&&setTimeout)return r=setTimeout,setTimeout(t,0);try{return r(t,0)}catch(e){try{return r.call(null,t,0)}catch(e){return r.call(this,t,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:o}catch(t){r=o}try{i="function"==typeof clearTimeout?clearTimeout:a}catch(t){i=a}}();var c,l=[],h=!1,u=-1;function d(){h&&c&&(h=!1,c.length?l=c.concat(l):u=-1,l.length&&f())}function f(){if(!h){var t=s(d);h=!0;for(var e=l.length;e;){for(c=l,l=[];++u<e;)c&&c[u].run();u=-1,e=l.length}c=null,h=!1,function(t){if(i===clearTimeout)return clearTimeout(t);if((i===a||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(t);try{i(t)}catch(e){try{return i.call(null,t)}catch(e){return i.call(this,t)}}}(t)}}function p(t,e){this.fun=t,this.array=e}function g(){}n.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];l.push(new p(t,e)),1!==l.length||h||s(f)},p.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=g,n.addListener=g,n.once=g,n.off=g,n.removeListener=g,n.removeAllListeners=g,n.emit=g,n.prependListener=g,n.prependOnceListener=g,n.listeners=function(t){return[]},n.binding=function(t){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(t){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},function(t,e,r){"use strict";var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){function e(e,r){var i=t.call(this)||this;return i.container=e,i.camera=r,i}return n(e,t),e}(r(3).EventEmitter);e.default=o},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getWheelDelta=e.getMouseCoords=e.getCenter=e.getHeight=e.getWidth=e.getY=e.getX=void 0;var i=r(10);function n(t){if(void 0!==t.offsetX)return t.offsetX;if(void 0!==t.clientX)return t.clientX;throw new Error("sigma/captors/utils.getX: could not extract x from event.")}function o(t){if(void 0!==t.offsetY)return t.offsetY;if(void 0!==t.clientY)return t.clientY;throw new Error("sigma/captors/utils.getY: could not extract y from event.")}function a(t){var e=t.target.width;if("number"==typeof e)return e;throw new Error("sigma/captors/utils.getWidth: could not extract width from event.")}function s(t){var e=t.target.height;if("number"==typeof e)return e;throw new Error("sigma/captors/utils.getHeight: could not extract height from event.")}e.getX=n,e.getY=o,e.getWidth=a,e.getHeight=s,e.getCenter=function(t){var e=i.getPixelRatio();return{x:a(t)/(2*e),y:s(t)/(2*e)}},e.getMouseCoords=function(t){return{x:n(t),y:o(t),clientX:t.clientX,clientY:t.clientY,ctrlKey:t.ctrlKey,metaKey:t.metaKey,altKey:t.altKey,shiftKey:t.shiftKey,preventDefault:t.preventDefault.bind(t),original:t}},e.getWheelDelta=function(t){if(void 0!==t.deltaY)return-3*t.deltaY/360;if(void 0!==t.detail)return t.detail/-9;throw new Error("sigma/captors/utils.getDelta: could not extract delta from event.")}},function(t,e,r){"use strict";var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=o(r(24)),s=o(r(11)),c=o(r(5)),l=o(r(1)),h=o(r(8)),u=o(r(7)),d=r(25),f=r(10),p=r(0),g=r(4),m=r(27),v=r(28),y=r(29),_=a.default.nodeExtent,b=a.default.edgeExtent,w=f.getPixelRatio(),x=f.getPixelRatio(),E=function(t){function e(e,r,i){void 0===i&&(i={});var n=t.call(this)||this;if(n.captors={},n.elements={},n.contexts={},n.listeners={},n.quadtree=new u.default,n.nodeDataCache={},n.edgeDataCache={},n.nodeExtent=null,n.edgeExtent=null,n.normalizationFunction=null,n.width=0,n.height=0,n.highlightedNodes=new Set,n.displayedLabels=new Set,n.hoveredNode=null,n.wasRenderedInThisFrame=!1,n.renderFrame=null,n.renderHighlightedNodesFrame=null,n.needToProcess=!1,n.needToSoftProcess=!1,n.nodePrograms={},n.edgePrograms={},n.settings=g.assign({},y.WEBGL_RENDERER_DEFAULT_SETTINGS,i),y.validateWebglRendererSettings(n.settings),!s.default(e))throw new Error("sigma/renderers/webgl: invalid graph instance.");if(!(r instanceof HTMLElement))throw new Error("sigma/renderers/webgl: container should be an html element.");n.graph=e,n.container=r,n.initializeCache(),n.createContext("edges"),n.createContext("edgeLabels",!1),n.createContext("nodes"),n.createContext("labels",!1),n.createContext("hovers",!1),n.createContext("mouse",!1);var o=n.contexts.nodes;for(var a in o.blendFunc(o.ONE,o.ONE_MINUS_SRC_ALPHA),o.enable(o.BLEND),(o=n.contexts.edges).blendFunc(o.ONE,o.ONE_MINUS_SRC_ALPHA),o.enable(o.BLEND),n.settings.nodeProgramClasses){var c=n.settings.nodeProgramClasses[a];n.nodePrograms[a]=new c(n.contexts.nodes)}for(var a in n.settings.edgeProgramClasses){var d=n.settings.edgeProgramClasses[a];n.edgePrograms[a]=new d(n.contexts.edges)}return n.resize(),n.camera=new l.default,n.bindCameraHandlers(),n.captors={mouse:new h.default(n.elements.mouse,n.camera)},n.bindEventHandlers(),n.bindGraphHandlers(),n.process(),n.render(),n}return n(e,t),e.prototype.createContext=function(t,e){void 0===e&&(e=!0);var r=f.createElement("canvas",{class:"sigma-"+t,style:{position:"absolute"}});this.elements[t]=r,this.container.appendChild(r);var i,n={preserveDrawingBuffer:!1,antialias:!1};return e?((i=r.getContext("webgl2",n))||(i=r.getContext("webgl",n)),i||(i=r.getContext("experimental-webgl",n))):i=r.getContext("2d",n),this.contexts[t]=i,this},e.prototype.initializeCache=function(){for(var t=this.graph,e=t.nodes(),r=0,i=e.length;r<i;r++)this.nodeDataCache[e[r]]=new d.NodeDisplayData(r,this.settings);var n=t.edges();for(r=0,i=n.length;r<i;r++)this.edgeDataCache[n[r]]=new d.EdgeDisplayData(r,this.settings)},e.prototype.bindCameraHandlers=function(){var t=this;return this.listeners.camera=function(){t.scheduleRender()},this.camera.on("updated",this.listeners.camera),this},e.prototype.bindEventHandlers=function(){var t=this;this.listeners.handleResize=function(){t.needToSoftProcess=!0,t.scheduleRender()},window.addEventListener("resize",this.listeners.handleResize);var e=function(t,e,r,i,n){return t>r-n&&t<r+n&&e>i-n&&e<i+n&&Math.sqrt(Math.pow(t-r,2)+Math.pow(e-i,2))<n},r=function(e,r){var i=t.camera.viewportToGraph(t,e,r);return t.quadtree.point(i.x,1-i.y)};this.listeners.handleMove=function(i){for(var n=Math.pow(t.camera.getState().ratio,.5),o=r(i.x,i.y),a=1/0,s=null,c=0,l=o.length;c<l;c++){var h=o[c],u=t.nodeDataCache[h],d=t.camera.graphToViewport(t,u.x,u.y),f=u.size/n;if(e(i.x,i.y,d.x,d.y,f)){var p=Math.sqrt(Math.pow(i.x-d.x,2)+Math.pow(i.y-d.y,2));p<a&&(a=p,s=h)}}if(s&&t.hoveredNode!==s)return null!==t.hoveredNode&&t.emit("leaveNode",{node:t.hoveredNode}),t.hoveredNode=s,t.emit("enterNode",{node:s}),void t.scheduleHighlightedNodesRender();if(t.hoveredNode){u=t.nodeDataCache[t.hoveredNode],d=t.camera.graphToViewport(t,u.x,u.y),f=u.size/n;if(!e(i.x,i.y,d.x,d.y,f)){h=t.hoveredNode;return t.hoveredNode=null,t.emit("leaveNode",{node:h}),t.scheduleHighlightedNodesRender()}}};var i=function(i){return function(n){for(var o=Math.pow(t.camera.getState().ratio,.5),a=r(n.x,n.y),s=0,c=a.length;s<c;s++){var l=a[s],h=t.nodeDataCache[l],u=t.camera.graphToViewport(t,h.x,h.y),d=h.size/o;if(e(n.x,n.y,u.x,u.y,d))return t.emit(i+"Node",{node:l,captor:n,event:n})}return t.emit(i+"Stage",{event:n})}};return this.listeners.handleClick=i("click"),this.listeners.handleRightClick=i("rightClick"),this.listeners.handleDown=i("down"),this.captors.mouse.on("mousemove",this.listeners.handleMove),this.captors.mouse.on("click",this.listeners.handleClick),this.captors.mouse.on("rightClick",this.listeners.handleRightClick),this.captors.mouse.on("mousedown",this.listeners.handleDown),this},e.prototype.bindGraphHandlers=function(){var t=this,e=this.graph;return this.listeners.graphUpdate=function(){t.needToProcess=!0,t.scheduleRender()},this.listeners.softGraphUpdate=function(){t.needToSoftProcess=!0,t.scheduleRender()},this.listeners.addNodeGraphUpdate=function(r){t.nodeDataCache[r.key]=new d.NodeDisplayData(e.order-1,t.settings),t.listeners.graphUpdate()},this.listeners.addEdgeGraphUpdate=function(r){t.edgeDataCache[r.key]=new d.EdgeDisplayData(e.size-1,t.settings),t.listeners.graphUpdate()},e.on("nodeAdded",this.listeners.addNodeGraphUpdate),e.on("nodeDropped",this.listeners.graphUpdate),e.on("nodeAttributesUpdated",this.listeners.softGraphUpdate),e.on("edgeAdded",this.listeners.addEdgeGraphUpdate),e.on("nodeDropped",this.listeners.graphUpdate),e.on("edgeAttributesUpdated",this.listeners.softGraphUpdate),e.on("cleared",this.listeners.graphUpdate),this},e.prototype.process=function(t){void 0===t&&(t=!1);var e=this.graph,r=this.settings;this.quadtree.clear();var i=["x","y"];this.settings.zIndex&&(i.push("z"),this.edgeExtent=b(e,["z"])),this.nodeExtent=_(e,i),this.normalizationFunction=f.createNormalizationFunction(this.nodeExtent);var n=this.nodePrograms[this.settings.defaultNodeType];t||n.allocate(e.order);var o=e.nodes();this.settings.zIndex&&(o=v.zIndexOrdering(this.edgeExtent.z,(function(t){return e.getNodeAttribute(t,"z")}),o));for(var a=0,s=o.length;a<s;a++){var c=o[a],l=e.getNodeAttributes(c),h=this.nodeDataCache[c];r.nodeReducer&&(l=r.nodeReducer(c,l)),h.assign(l),this.normalizationFunction.applyTo(h),this.quadtree.add(c,h.x,1-h.y,h.size/this.width),n.process(h,a),h.index=a}n.bufferData();var u=this.edgePrograms[this.settings.defaultEdgeType];t||u.allocate(e.size);var d=e.edges();this.settings.zIndex&&(d=v.zIndexOrdering(this.edgeExtent.z,(function(t){return e.getEdgeAttribute(t,"z")}),d));for(a=0,s=d.length;a<s;a++){var p=d[a];l=e.getEdgeAttributes(p),h=this.edgeDataCache[p];r.edgeReducer&&(l=r.edgeReducer(p,l)),h.assign(l);var g=e.extremities(p),m=this.nodeDataCache[g[0]],y=this.nodeDataCache[g[1]];u.process(m,y,h,a),h.index=a}return t||"function"!=typeof u.computeIndices||u.computeIndices(),u.bufferData(),this},e.prototype.processNode=function(t){var e=this.nodePrograms[this.settings.defaultNodeType],r=this.graph.getNodeAttributes(t);return e.process(r,this.nodeDataCache[t].index),this},e.prototype.processEdge=function(t){var e=this.graph,r=this.edgePrograms[this.settings.defaultEdgeType],i=e.getEdgeAttributes(t),n=e.extremities(t),o=e.getNodeAttributes(n[0]),a=e.getNodeAttributes(n[1]);return r.process(o,a,i,this.edgeDataCache[t].index),this},e.prototype.getCamera=function(){return this.camera},e.prototype.getMouseCaptor=function(){return this.captors.mouse},e.prototype.resize=function(t,e){var r=this.width,i=this.height;if(t&&e?(this.width=t,this.height=e):(this.width=this.container.offsetWidth,this.height=this.container.offsetHeight),0===this.width)throw new Error("sigma/renderers/webgl: container has no width.");if(0===this.height)throw new Error("sigma/renderers/webgl: container has no height.");if(r===this.width&&i===this.height)return this;for(var n in this.elements){var o=this.elements[n];o.style.width=this.width+"px",o.style.height=this.height+"px"}for(var n in this.contexts){var a=this.contexts[n];a.scale?(this.elements[n].setAttribute("width",this.width*w+"px"),this.elements[n].setAttribute("height",this.height*w+"px"),1!==w&&a.scale(w,w)):(this.elements[n].setAttribute("width",this.width*x+"px"),this.elements[n].setAttribute("height",this.height*x+"px")),a.viewport&&a.viewport(0,0,this.width*x,this.height*x)}return this},e.prototype.clear=function(){return this.contexts.nodes.clear(this.contexts.nodes.COLOR_BUFFER_BIT),this.contexts.edges.clear(this.contexts.edges.COLOR_BUFFER_BIT),this.contexts.labels.clearRect(0,0,this.width,this.height),this.contexts.hovers.clearRect(0,0,this.width,this.height),this.contexts.edgeLabels.clearRect(0,0,this.width,this.height),this},e.prototype.render=function(){if(this.renderFrame&&(cancelAnimationFrame(this.renderFrame),this.renderFrame=null,this.needToProcess=!1,this.needToSoftProcess=!1),this.resize(),this.clear(),!this.graph.order)return this;var t=this.camera.isAnimated()||this.captors.mouse.isMoving||this.captors.mouse.hasDragged||this.captors.mouse.wheelLock,e=this.camera.getState(),r=p.matrixFromCamera(e,{width:this.width,height:this.height});return this.nodePrograms[this.settings.defaultNodeType].render({matrix:r,width:this.width,height:this.height,ratio:e.ratio,nodesPowRatio:.5,scalingRatio:x}),this.settings.hideEdgesOnMove&&t||this.edgePrograms[this.settings.defaultEdgeType].render({matrix:r,width:this.width,height:this.height,ratio:e.ratio,nodesPowRatio:.5,edgesPowRatio:.5,scalingRatio:x}),this.settings.hideLabelsOnMove&&t||(this.renderLabels(),this.renderEdgeLabels(),this.renderHighlightedNodes()),this},e.prototype.renderLabels=function(){if(!this.settings.renderLabels)return this;var t,e=this.camera.getState();if(e.ratio>=1)t=this.graph.nodes();else{var r=this.camera.viewRectangle(this);t=this.quadtree.rectangle(r.x1,1-r.y1,r.x2,1-r.y2,r.height)}for(var i=this.settings.labelGrid,n=m.labelsToDisplayFromGrid({cache:this.nodeDataCache,camera:this.camera,cell:i.cell,dimensions:this,displayedLabels:this.displayedLabels,fontSize:this.settings.labelSize,graph:this.graph,renderedSizeThreshold:i.renderedSizeThreshold,visibleNodes:t}),o=this.contexts.labels,a=Math.pow(e.ratio,.5),s=0,c=n.length;s<c;s++){var l=this.nodeDataCache[n[s]],h=this.camera.graphToViewport(this,l.x,l.y),u=h.x,d=h.y,f=l.size/a;this.settings.labelRenderer(o,{key:n[s],label:l.label,color:"#000",size:f,x:u,y:d},this.settings)}return this.displayedLabels=new Set(n),this},e.prototype.renderEdgeLabels=function(){if(!this.settings.renderEdgeLabels)return this;var t=this.camera.getState(),e=Math.pow(t.ratio,.5),r=this.contexts.edgeLabels;r.clearRect(0,0,this.width,this.height);for(var i=m.edgeLabelsToDisplayFromNodes({graph:this.graph,hoveredNode:this.hoveredNode,displayedNodeLabels:this.displayedLabels,highlightedNodes:this.highlightedNodes}),n=0,o=i.length;n<o;n++){var a=i[n],s=this.graph.extremities(a),c=this.nodeDataCache[s[0]],l=this.nodeDataCache[s[1]],h=this.edgeDataCache[i[n]],u=this.camera.graphToViewport(this,c.x,c.y),d=u.x,f=u.y,p=this.camera.graphToViewport(this,l.x,l.y),g=p.x,v=p.y,y=h.size/e;this.settings.edgeLabelRenderer(r,{key:a,label:h.label,color:h.color,size:y},{key:s[0],x:d,y:f},{key:s[1],x:g,y:v},this.settings)}return this},e.prototype.renderHighlightedNodes=function(){var t=this,e=this.camera,r=Math.pow(e.getState().ratio,.5),i=this.contexts.hovers;i.clearRect(0,0,this.width,this.height);var n=function(n){var o=t.nodeDataCache[n],a=e.graphToViewport(t,o.x,o.y),s=a.x,c=a.y,l=o.size/r;t.settings.hoverRenderer(i,{key:n,label:o.label,color:o.color,size:l,x:s,y:c},t.settings)};null!==this.hoveredNode&&n(this.hoveredNode),this.highlightedNodes.forEach(n)},e.prototype.scheduleRender=function(){var t=this;this.renderFrame||(this.renderFrame=requestAnimationFrame((function(){t.needToProcess?t.process():t.needToSoftProcess&&t.process(!0),t.renderFrame=null,t.needToProcess=!1,t.needToSoftProcess=!1,t.render()})))},e.prototype.scheduleHighlightedNodesRender=function(){var t=this;this.renderHighlightedNodesFrame||this.renderFrame||(this.renderHighlightedNodesFrame=requestAnimationFrame((function(){t.renderHighlightedNodesFrame=null,t.renderHighlightedNodes(),t.renderEdgeLabels()})))},e.prototype.refresh=function(){return this.needToSoftProcess=!0,this.scheduleRender(),this},e.prototype.highlightNode=function(t){return this.highlightedNodes.add(t),this.scheduleHighlightedNodesRender(),this},e.prototype.unhighlightNode=function(t){return this.highlightedNodes.delete(t),this.scheduleHighlightedNodesRender(),this},e.prototype.kill=function(){var t=this.graph;this.emit("kill"),this.removeAllListeners(),this.camera.removeListener("updated",this.listeners.camera),window.removeEventListener("resize",this.listeners.handleResize),this.captors.mouse.kill(),t.removeListener("nodeAdded",this.listeners.addNodeGraphUpdate),t.removeListener("nodeDropped",this.listeners.graphUpdate),t.removeListener("nodeAttributesUpdated",this.listeners.softGraphUpdate),t.removeListener("edgeAdded",this.listeners.addEdgeGraphUpdate),t.removeListener("nodeDropped",this.listeners.graphUpdate),t.removeListener("edgeAttributesUpdated",this.listeners.softGraphUpdate),t.removeListener("cleared",this.listeners.graphUpdate),this.quadtree=new u.default,this.nodeDataCache={},this.edgeDataCache={},this.highlightedNodes=new Set,this.displayedLabels=new Set,this.renderFrame&&(cancelAnimationFrame(this.renderFrame),this.renderFrame=null),this.renderHighlightedNodesFrame&&(cancelAnimationFrame(this.renderHighlightedNodesFrame),this.renderHighlightedNodesFrame=null);for(var e=this.container;e.firstChild;)e.removeChild(e.firstChild)},e}(c.default);e.default=E},function(t,e,r){var i=r(11);function n(t,e){if(!i(t))throw new Error("graphology-metrics/extent: the given graph is not a valid graphology instance.");var r,n,o,a,s,c,l,h=[].concat(e),u=t.nodes(),d={};for(s=0;s<h.length;s++)d[a=h[s]]=[1/0,-1/0];for(c=0,l=u.length;c<l;c++)for(r=u[c],n=t.getNodeAttributes(r),s=0;s<h.length;s++)(o=n[a=h[s]])<d[a][0]&&(d[a][0]=o),o>d[a][1]&&(d[a][1]=o);return"string"==typeof e?d[e]:d}var o=n;o.nodeExtent=n,o.edgeExtent=function(t,e){if(!i(t))throw new Error("graphology-metrics/extent: the given graph is not a valid graphology instance.");var r,n,o,a,s,c,l,h=[].concat(e),u=t.edges(),d={};for(s=0;s<h.length;s++)d[a=h[s]]=[1/0,-1/0];for(c=0,l=u.length;c<l;c++)for(r=u[c],n=t.getEdgeAttributes(r),s=0;s<h.length;s++)(o=n[a=h[s]])<d[a][0]&&(d[a][0]=o),o>d[a][1]&&(d[a][1]=o);return"string"==typeof e?d[e]:d},t.exports=o},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EdgeDisplayData=e.NodeDisplayData=void 0;var i=function(){function t(t,e){this.index=t,this.x=0,this.y=0,this.size=2,this.color=e.defaultNodeColor,this.hidden=!1,this.label=""}return t.prototype.assign=function(t){Object.assign(this,t)},t}();e.NodeDisplayData=i;var n=function(){function t(t,e){this.index=t,this.size=1,this.color=e.defaultEdgeColor,this.hidden=!1,this.label=""}return t.prototype.assign=function(t){Object.assign(this,t)},t}();e.EdgeDisplayData=n},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.multiply=e.translate=e.rotate=e.scale=e.identity=void 0,e.identity=function(){return Float32Array.of(1,0,0,0,1,0,0,0,1)},e.scale=function(t,e,r){return t[0]=e,t[4]=null!=r?r:e,t},e.rotate=function(t,e){var r=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=r,t[3]=-r,t[4]=i,t},e.translate=function(t,e,r){return t[6]=e,t[7]=r,t},e.multiply=function(t,e){var r=t[0],i=t[1],n=t[2],o=t[3],a=t[4],s=t[5],c=t[6],l=t[7],h=t[8],u=e[0],d=e[1],f=e[2],p=e[3],g=e[4],m=e[5],v=e[6],y=e[7],_=e[8];return t[0]=u*r+d*o+f*c,t[1]=u*i+d*a+f*l,t[2]=u*n+d*s+f*h,t[3]=p*r+g*o+m*c,t[4]=p*i+g*a+m*l,t[5]=p*n+g*s+m*h,t[6]=v*r+y*o+_*c,t[7]=v*i+y*a+_*l,t[8]=v*n+y*s+_*h,t}},function(t,e,r){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.edgeLabelsToDisplayFromNodes=e.labelsToDisplayFromGrid=void 0;var n=i(r(1)),o={width:250,height:175},a={width:400,height:300};e.labelsToDisplayFromGrid=function(t){var e=t.cache,r=t.camera,i=t.cell,s=t.dimensions,c=t.displayedLabels,l=t.fontSize,h=void 0===l?14:l,u=t.graph,d=t.renderedSizeThreshold,f=void 0===d?-1/0:d,p=t.visibleNodes,g=r.getState(),m=r.getPreviousState(),v=new n.default;v.setState(m);var y=Math.pow(g.ratio,.5),_=g.x===m.x&&g.y===m.y&&g.ratio===m.ratio,b=g.ratio<m.ratio,w=g.x!==m.x||g.y!==m.y,x=g.ratio>m.ratio,E=!b&&!x&&g.ratio>=1,L=w&&c.size&&!b&&!x;if(x&&Math.trunc(100*g.ratio)%5!=0)return Array.from(c);if((E||_)&&0!==c.size)return Array.from(c);if(b&&g.ratio>=1)return Array.from(c);var A=i||o;g.ratio>=1.3&&(A=a);for(var T=s.width%A.width,P=A.width+T/Math.floor(s.width/A.width),O=s.height%A.height,M=A.height+O/Math.floor(s.height/A.height),S=s.width+P,N=s.height+M,C=-P,R=-M,F=s.width+P/2,D=s.height+M/2,k=-P/2,I=-M/2,j=[],z={},U=-1/0,G=null,B=0,Y=p.length;B<Y;B++){var V=e[rt=p[B]];if(!(V.size/y<f)){var q=r.graphToViewport(s,V.x,V.y);if(!(q.x<C||q.x>S||q.y<R||q.y>N)){if(V.size>U&&(U=V.size,G=rt),L){var H=v.graphToViewport(s,V.x,V.y);if(H.x>=k&&H.x<=F&&H.y>=I&&H.y<=D&&!c.has(rt))continue}if(void 0===z[et=Math.floor(q.x/P)+""+Math.floor(q.y/M)])z[et]=rt;else{var W=z[et],X=e[W];if(c.size>0){var K=c.has(rt),$=c.has(W);if(!K&&$)continue;if(K&&!$){z[et]=rt;continue}if((L||b)&&K&&$){j.push(rt);continue}}var Q=!1;if(V.size>X.size)Q=!0;else if(V.size===X.size){var Z=u.degree(rt),J=u.degree(W);(Z>J||Z===J&&rt>W)&&(Q=!0)}Q&&(z[et]=rt)}}}}var tt=j.some((function(t){return t===G}));for(var et in z){var rt;(rt=z[et])===G&&(tt=!0),j.push(rt)}!tt&&G&&j.push(G);var it,nt,ot,at,st,ct,lt,ht,ut=new Set;for(B=0,Y=j.length;B<Y;B++){var dt=e[K=j[B]],ft=r.graphToViewport(s,dt.x,dt.y);if(!ut.has(K))for(var pt=B+1;pt<Y;pt++){var gt=e[$=j[pt]],mt=r.graphToViewport(s,gt.x,gt.y);(it=ft.x,nt=ft.y,ot=8*dt.label.length,at=h,st=mt.x,ct=mt.y,lt=8*gt.label.length,ht=h,it<st+lt&&it+ot>st&&nt<ct+ht&&nt+at>ct)&&(dt.size<gt.size?ut.add(K):ut.add($))}}return j.filter((function(t){return!ut.has(t)}))},e.edgeLabelsToDisplayFromNodes=function(t){var e=t.graph,r=t.hoveredNode,i=t.highlightedNodes,n=t.displayedNodeLabels,o=new Set,a=Array.from(n),s=Array.from(i);r&&!i.has(r)&&s.push(r);for(var c=0;c<s.length;c++)for(var l=s[c],h=e.edges(l),u=0;u<h.length;u++)o.add(h[u]);for(c=0;c<a.length;c++)for(l=a[c],h=e.outboundEdges(l),u=0;u<h.length;u++)n.has(e.opposite(l,h[u]))&&o.add(h[u]);return Array.from(o)}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.zIndexOrdering=void 0,e.zIndexOrdering=function(t,e,r){return r.sort((function(t,r){var i=e(t)||0,n=e(r)||0;return i<n?-1:i>n?1:0}))}},function(t,e,r){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.WEBGL_RENDERER_DEFAULT_SETTINGS=e.validateWebglRendererSettings=void 0;var n=i(r(12)),o=i(r(30)),a=i(r(32)),s=i(r(33)),c=i(r(38)),l=i(r(40));e.validateWebglRendererSettings=function(t){if(t.labelGrid&&t.labelGrid.cell&&"object"==typeof t.labelGrid.cell&&(!t.labelGrid.cell.width||!t.labelGrid.cell.height))throw new Error("sigma/renderers/webgl/settings: invalid `labelGrid.cell`. Expecting {width, height}.")},e.WEBGL_RENDERER_DEFAULT_SETTINGS={hideEdgesOnMove:!1,hideLabelsOnMove:!1,renderLabels:!0,renderEdgeLabels:!1,defaultNodeColor:"#999",defaultNodeType:"circle",defaultEdgeColor:"#ccc",defaultEdgeType:"line",labelFont:"Arial",labelSize:14,labelWeight:"normal",edgeLabelFont:"Arial",edgeLabelSize:14,edgeLabelWeight:"normal",labelGrid:{cell:null,renderedSizeThreshold:-1/0},nodeReducer:null,edgeReducer:null,zIndex:!1,labelRenderer:n.default,hoverRenderer:o.default,edgeLabelRenderer:a.default,nodeProgramClasses:{circle:s.default},edgeProgramClasses:{arrow:l.default,line:c.default}}},function(t,e,r){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var n=i(r(31)),o=i(r(12));e.default=function(t,e,r){var i=r.labelSize,a=r.labelFont,s=r.labelWeight;t.font=s+" "+i+"px "+a,t.beginPath(),t.fillStyle="#fff",t.shadowOffsetX=0,t.shadowOffsetY=0,t.shadowBlur=8,t.shadowColor="#000";var c=t.measureText(e.label).width,l=Math.round(e.x-i/2-2),h=Math.round(e.y-i/2-2),u=Math.round(c+i/2+e.size+9),d=Math.round(i+4),f=Math.round(i/2+2);t.moveTo(l,h+f),t.moveTo(l,h+f),t.arcTo(l,h,l+f,h,f),t.lineTo(l+u,h),t.lineTo(l+u,h+d),t.lineTo(l+f,h+d),t.arcTo(l,h+d,l,h+d-f,f),t.lineTo(l,h+f),t.closePath(),t.fill(),t.shadowOffsetX=0,t.shadowOffsetY=0,t.shadowBlur=0,n.default(t,e),o.default(t,e,r)}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=2*Math.PI;e.default=function(t,e){t.fillStyle=e.color,t.beginPath(),t.arc(e.x,e.y,e.size,0,i,!0),t.closePath(),t.fill()}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e,r,i,n){var o=n.edgeLabelSize,a=n.edgeLabelFont,s=n.edgeLabelWeight,c=e.label;t.fillStyle=e.color,t.font=s+" "+o+"px "+a;var l,h=t.measureText(c).width,u=(r.x+i.x)/2,d=(r.y+i.y)/2,f=i.x-r.x,p=i.y-r.y,g=Math.sqrt(f*f+p*p);l=f>0?p>0?Math.acos(f/g):Math.asin(p/g):p>0?Math.acos(f/g)+Math.PI:Math.asin(f/g)+Math.PI/2,t.save(),t.translate(u,d),t.rotate(l),t.fillText(c,-h/2,e.size/2+o),t.restore()}},function(t,e,r){"use strict";var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=r(34),s=r(0),c=o(r(36)),l=o(r(37)),h=function(t){function e(e){var r=t.call(this,e,c.default,l.default,1,4)||this;return r.bind(),r}return n(e,t),e.prototype.process=function(t,e){var r=s.floatColor(t.color),i=1*e*4,n=this.array;if(t.hidden)return n[i++]=0,n[i++]=0,n[i++]=0,void(n[i++]=0);n[i++]=t.x,n[i++]=t.y,n[i++]=t.size,n[i]=r},e.prototype.render=function(t){var e=this.gl,r=this.program;e.useProgram(r),e.uniform1f(this.ratioLocation,1/Math.pow(t.ratio,t.nodesPowRatio)),e.uniform1f(this.scaleLocation,t.scalingRatio),e.uniformMatrix3fv(this.matrixLocation,!1,t.matrix),e.drawArrays(e.POINTS,0,this.array.length/4)},e}(a.AbstractNodeProgram);e.default=h},function(t,e,r){"use strict";var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.createNodeCompoundProgram=e.AbstractNodeProgram=void 0;var o=function(t){function e(e,r,i,n,o){var a=t.call(this,e,r,i,n,o)||this;a.positionLocation=e.getAttribLocation(a.program,"a_position"),a.sizeLocation=e.getAttribLocation(a.program,"a_size"),a.colorLocation=e.getAttribLocation(a.program,"a_color");var s=e.getUniformLocation(a.program,"u_matrix");if(null===s)throw new Error("sigma/renderers/webgl/program/common/node: error while getting matrixLocation");a.matrixLocation=s;var c=e.getUniformLocation(a.program,"u_ratio");if(null===c)throw new Error("sigma/renderers/webgl/program/common/node: error while getting ratioLocation");a.ratioLocation=c;var l=e.getUniformLocation(a.program,"u_scale");if(null===l)throw new Error("sigma/renderers/webgl/program/common/node: error while getting scaleLocation");return a.scaleLocation=l,a}return n(e,t),e.prototype.bind=function(){var t=this.gl;t.enableVertexAttribArray(this.positionLocation),t.enableVertexAttribArray(this.sizeLocation),t.enableVertexAttribArray(this.colorLocation),t.vertexAttribPointer(this.positionLocation,2,t.FLOAT,!1,this.attributes*Float32Array.BYTES_PER_ELEMENT,0),t.vertexAttribPointer(this.sizeLocation,1,t.FLOAT,!1,this.attributes*Float32Array.BYTES_PER_ELEMENT,8),t.vertexAttribPointer(this.colorLocation,4,t.UNSIGNED_BYTE,!0,this.attributes*Float32Array.BYTES_PER_ELEMENT,12)},e}(r(13).AbstractProgram);e.AbstractNodeProgram=o,e.createNodeCompoundProgram=function(t){return function(){function e(e){this.programs=t.map((function(t){return new t(e)}))}return e.prototype.bufferData=function(){this.programs.forEach((function(t){return t.bufferData()}))},e.prototype.allocate=function(t){this.programs.forEach((function(e){return e.allocate(t)}))},e.prototype.bind=function(){},e.prototype.render=function(t){this.programs.forEach((function(e){return e.render(t)}))},e.prototype.process=function(t,e){this.programs.forEach((function(r){return r.process(t,e)}))},e}()}},function(t,e,r){"use strict";function i(t,e,r){var i="VERTEX"===t?e.VERTEX_SHADER:e.FRAGMENT_SHADER,n=e.createShader(i);if(null===n)throw new Error("sigma/renderers/webgl/shaders/utils.loadShader: error while creating the shader");if(e.shaderSource(n,r),e.compileShader(n),!e.getShaderParameter(n,e.COMPILE_STATUS)){var o=e.getShaderInfoLog(n);throw e.deleteShader(n),new Error("sigma/renderers/webgl/shaders/utils.loadShader: error while compiling the shader:\n"+o+"\n"+r)}return n}Object.defineProperty(e,"__esModule",{value:!0}),e.loadProgram=e.loadFragmentShader=e.loadVertexShader=void 0,e.loadVertexShader=function(t,e){return i("VERTEX",t,e)},e.loadFragmentShader=function(t,e){return i("FRAGMENT",t,e)},e.loadProgram=function(t,e){var r,i,n=t.createProgram();if(null===n)throw new Error("sigma/renderers/webgl/shaders/utils.loadProgram: error while creating the program.");for(r=0,i=e.length;r<i;r++)t.attachShader(n,e[r]);if(t.linkProgram(n),!t.getProgramParameter(n,t.LINK_STATUS))throw t.deleteProgram(n),new Error("sigma/renderers/webgl/shaders/utils.loadProgram: error while linking the program.");return n}},function(t,e,r){"use strict";r.r(e),e.default="attribute vec2 a_position;\nattribute float a_size;\nattribute vec4 a_color;\n\nuniform float u_ratio;\nuniform float u_scale;\nuniform mat3 u_matrix;\n\nvarying vec4 v_color;\nvarying float v_border;\n\nconst float bias = 255.0 / 254.0;\n\nvoid main() {\n\n  gl_Position = vec4(\n    (u_matrix * vec3(a_position, 1)).xy,\n    0,\n    1\n  );\n\n  // Multiply the point size twice:\n  //  - x SCALING_RATIO to correct the canvas scaling\n  //  - x 2 to correct the formulae\n  gl_PointSize = a_size * u_ratio * u_scale * 2.0;\n\n  v_border = (1.0 / u_ratio) * (0.5 / a_size);\n\n  // Extract the color:\n  v_color = a_color;\n  v_color.a *= bias;\n}\n"},function(t,e,r){"use strict";r.r(e),e.default="precision mediump float;\n\nvarying vec4 v_color;\nvarying float v_border;\n\nconst float radius = 0.5;\n\nvoid main(void) {\n  vec4 color0 = vec4(0.0, 0.0, 0.0, 0.0);\n  vec2 m = gl_PointCoord - vec2(0.5, 0.5);\n  float dist = radius - length(m);\n\n  float t = 0.0;\n  if (dist > v_border)\n    t = 1.0;\n  else if (dist > 0.0)\n    t = dist / v_border;\n\n  // gl_FragColor = mix(color0, v_color, t);\n  gl_FragColor = mix(color0, v_color, t);\n}\n"},function(t,e,r){"use strict";var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=r(2),s=r(0),c=o(r(39)),l=o(r(14)),h=function(t){function e(e){var r=t.call(this,e,c.default,l.default,4,6)||this,i=e.createBuffer();if(null===i)throw new Error("sigma/renderers/webgl/program/edge.EdgeProgram: error while getting resolutionLocation");r.indicesBuffer=i,r.normalLocation=e.getAttribLocation(r.program,"a_normal"),r.thicknessLocation=e.getAttribLocation(r.program,"a_thickness");var n=e.getUniformLocation(r.program,"u_ratio");if(null===n)throw new Error("sigma/renderers/webgl/program/edge.EdgeProgram: error while getting ratioLocation");r.ratioLocation=n;var o=e.getUniformLocation(r.program,"u_scale");if(null===o)throw new Error("sigma/renderers/webgl/program/edge.EdgeProgram: error while getting scaleLocation");return r.scaleLocation=o,r.canUse32BitsIndices=s.canUse32BitsIndices(e),r.IndicesArray=r.canUse32BitsIndices?Uint32Array:Uint16Array,r.indicesArray=new r.IndicesArray,r.indicesType=r.canUse32BitsIndices?e.UNSIGNED_INT:e.UNSIGNED_SHORT,r.bind(),r}return n(e,t),e.prototype.bind=function(){var t=this.gl;t.enableVertexAttribArray(this.positionLocation),t.enableVertexAttribArray(this.normalLocation),t.enableVertexAttribArray(this.thicknessLocation),t.enableVertexAttribArray(this.colorLocation),t.vertexAttribPointer(this.positionLocation,2,t.FLOAT,!1,6*Float32Array.BYTES_PER_ELEMENT,0),t.vertexAttribPointer(this.normalLocation,2,t.FLOAT,!1,6*Float32Array.BYTES_PER_ELEMENT,8),t.vertexAttribPointer(this.thicknessLocation,1,t.FLOAT,!1,6*Float32Array.BYTES_PER_ELEMENT,16),t.vertexAttribPointer(this.colorLocation,4,t.UNSIGNED_BYTE,!0,6*Float32Array.BYTES_PER_ELEMENT,20)},e.prototype.computeIndices=function(){for(var t=this.array.length/6,e=t+t/2,r=new this.IndicesArray(e),i=0,n=0;i<t;i+=4)r[n++]=i,r[n++]=i+1,r[n++]=i+2,r[n++]=i+2,r[n++]=i+1,r[n++]=i+3;this.indicesArray=r},e.prototype.bufferData=function(){t.prototype.bufferData.call(this);var e=this.gl;e.bufferData(e.ELEMENT_ARRAY_BUFFER,this.indicesArray,e.STATIC_DRAW)},e.prototype.process=function(t,e,r,i){if(t.hidden||e.hidden||r.hidden)for(var n=24*i,o=n+24;n<o;n++)this.array[n]=0;else{var a=r.size||1,c=t.x,l=t.y,h=e.x,u=e.y,d=s.floatColor(r.color),f=h-c,p=u-l,g=f*f+p*p,m=0,v=0;g&&(m=-p*(g=1/Math.sqrt(g)),v=f*g);var y=24*i,_=this.array;_[y++]=c,_[y++]=l,_[y++]=m,_[y++]=v,_[y++]=a,_[y++]=d,_[y++]=c,_[y++]=l,_[y++]=-m,_[y++]=-v,_[y++]=a,_[y++]=d,_[y++]=h,_[y++]=u,_[y++]=m,_[y++]=v,_[y++]=a,_[y++]=d,_[y++]=h,_[y++]=u,_[y++]=-m,_[y++]=-v,_[y++]=a,_[y]=d}},e.prototype.render=function(t){var e=this.gl,r=this.program;e.useProgram(r),e.uniform2f(this.resolutionLocation,t.width,t.height),e.uniform1f(this.ratioLocation,t.ratio),e.uniformMatrix3fv(this.matrixLocation,!1,t.matrix),e.uniform1f(this.scaleLocation,t.scalingRatio),e.drawElements(e.TRIANGLES,this.indicesArray.length,this.indicesType,0)},e}(a.AbstractEdgeProgram);e.default=h},function(t,e,r){"use strict";r.r(e),e.default="attribute vec2 a_position;\nattribute vec2 a_normal;\nattribute float a_thickness;\nattribute vec4 a_color;\n\nuniform vec2 u_resolution;\nuniform float u_ratio;\nuniform mat3 u_matrix;\nuniform float u_scale;\n\nvarying vec4 v_color;\nvarying vec2 v_normal;\nvarying float v_thickness;\n\nconst float min_thickness = 1.8;\nconst float bias = 255.0 / 254.0;\n\nvoid main() {\n\n  // Computing thickness in pixels\n  float pow_ratio = 1.0 / pow(u_ratio, 0.5);\n  float thickness = a_thickness * pow_ratio / u_scale;\n\n  // Min thickness for AA\n  thickness = max(min_thickness, thickness);\n\n  // Computing delta relative to viewport\n  vec2 delta = (a_normal * thickness) / u_resolution;\n\n  vec2 position = (u_matrix * vec3(a_position, 1)).xy;\n  position += delta;\n\n  // Applying\n  gl_Position = vec4(position, 0, 1);\n\n  v_normal = a_normal;\n  v_thickness = thickness;\n\n  // Extract the color:\n  v_color = a_color;\n  v_color.a *= bias;\n}\n"},function(t,e,r){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var n=r(2),o=i(r(41)),a=i(r(44)),s=n.createEdgeCompoundProgram([a.default,o.default]);e.default=s},function(t,e,r){"use strict";var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=r(2),s=r(0),c=o(r(42)),l=o(r(43)),h=function(t){function e(e){var r=t.call(this,e,c.default,l.default,3,10)||this;r.normalLocation=e.getAttribLocation(r.program,"a_normal"),r.thicknessLocation=e.getAttribLocation(r.program,"a_thickness"),r.radiusLocation=e.getAttribLocation(r.program,"a_radius"),r.barycentricLocation=e.getAttribLocation(r.program,"a_barycentric");var i=e.getUniformLocation(r.program,"u_ratio");if(null===i)throw new Error("sigma/renderers/webgl/program/edge.ArrowProgram: error while getting ratioLocation");r.ratioLocation=i;var n=e.getUniformLocation(r.program,"u_scale");if(null===n)throw new Error("sigma/renderers/webgl/program/edge.ArrowProgram: error while getting scaleLocation");return r.scaleLocation=n,r.bind(),r}return n(e,t),e.prototype.bind=function(){var t=this.gl;t.enableVertexAttribArray(this.positionLocation),t.enableVertexAttribArray(this.normalLocation),t.enableVertexAttribArray(this.thicknessLocation),t.enableVertexAttribArray(this.radiusLocation),t.enableVertexAttribArray(this.colorLocation),t.enableVertexAttribArray(this.barycentricLocation),t.vertexAttribPointer(this.positionLocation,2,t.FLOAT,!1,10*Float32Array.BYTES_PER_ELEMENT,0),t.vertexAttribPointer(this.normalLocation,2,t.FLOAT,!1,10*Float32Array.BYTES_PER_ELEMENT,8),t.vertexAttribPointer(this.thicknessLocation,1,t.FLOAT,!1,10*Float32Array.BYTES_PER_ELEMENT,16),t.vertexAttribPointer(this.radiusLocation,1,t.FLOAT,!1,10*Float32Array.BYTES_PER_ELEMENT,20),t.vertexAttribPointer(this.colorLocation,4,t.UNSIGNED_BYTE,!0,10*Float32Array.BYTES_PER_ELEMENT,24),t.vertexAttribPointer(this.barycentricLocation,3,t.FLOAT,!1,10*Float32Array.BYTES_PER_ELEMENT,28)},e.prototype.computeIndices=function(){},e.prototype.process=function(t,e,r,i){if(t.hidden||e.hidden||r.hidden)for(var n=30*i,o=n+30;n<o;n++)this.array[n]=0;else{var a=Math.max(2.5*(r.size||1),5),c=e.size||1,l=t.x,h=t.y,u=e.x,d=e.y,f=s.floatColor(r.color),p=u-l,g=d-h,m=p*p+g*g,v=0,y=0;m&&(v=-g*(m=1/Math.sqrt(m)),y=p*m);var _=30*i,b=this.array;b[_++]=u,b[_++]=d,b[_++]=-v,b[_++]=-y,b[_++]=a,b[_++]=c,b[_++]=f,b[_++]=1,b[_++]=0,b[_++]=0,b[_++]=u,b[_++]=d,b[_++]=-v,b[_++]=-y,b[_++]=a,b[_++]=c,b[_++]=f,b[_++]=0,b[_++]=1,b[_++]=0,b[_++]=u,b[_++]=d,b[_++]=-v,b[_++]=-y,b[_++]=a,b[_++]=c,b[_++]=f,b[_++]=0,b[_++]=0,b[_]=1}},e.prototype.render=function(t){var e=this.gl,r=this.program;e.useProgram(r),e.uniform2f(this.resolutionLocation,t.width,t.height),e.uniform1f(this.ratioLocation,t.ratio),e.uniformMatrix3fv(this.matrixLocation,!1,t.matrix),e.uniform1f(this.scaleLocation,t.scalingRatio),e.drawArrays(e.TRIANGLES,0,this.array.length/10)},e}(a.AbstractEdgeProgram);e.default=h},function(t,e,r){"use strict";r.r(e),e.default="attribute vec2 a_position;\nattribute vec2 a_normal;\nattribute float a_thickness;\nattribute float a_radius;\nattribute vec4 a_color;\nattribute vec3 a_barycentric;\n\nuniform vec2 u_resolution;\nuniform float u_ratio;\nuniform mat3 u_matrix;\nuniform float u_scale;\n\nvarying vec4 v_color;\n// varying vec3 v_barycentric;\n\nconst float arrow_ratio = 0.66;\nconst float bias = 255.0 / 254.0;\n\nvoid main() {\n\n  float da = a_barycentric.x;\n  float db = a_barycentric.y;\n  float dc = a_barycentric.z;\n\n  float pow_ratio = 1.0 / pow(u_ratio, 0.5) * 2.0;\n  float radius = (a_radius - 1.0) * pow_ratio;\n  float thickness = a_thickness * pow_ratio / u_scale;\n  float width = arrow_ratio * thickness / 2.0;\n\n  vec2 delta = vec2(\n      da * ((radius) * a_normal.y)\n    + db * ((radius + thickness) * a_normal.y + width * a_normal.x)\n    + dc * ((radius + thickness) * a_normal.y - width * a_normal.x),\n\n      da * (-(radius) * a_normal.x)\n    + db * (-(radius + thickness) * a_normal.x + width * a_normal.y)\n    + dc * (-(radius + thickness) * a_normal.x - width * a_normal.y)\n  );\n\n  delta /= u_resolution;\n\n  // Scale from [[-1 1] [-1 1]] to the container:\n  vec2 position = (u_matrix * vec3(a_position, 1)).xy;\n  position += delta;\n\n  // Applying\n  gl_Position = vec4(position, 0, 1);\n\n  // v_barycentric = a_barycentric;\n\n  // Extract the color:\n  v_color = a_color;\n  v_color.a *= bias;\n}\n"},function(t,e,r){"use strict";r.r(e),e.default="precision mediump float;\n\nvarying vec4 v_color;\n// varying vec3 v_barycentric;\n\nvoid main(void) {\n  // if (any(lessThan(v_barycentric, vec3(0.01))))\n  //   discard;\n  // else\n    gl_FragColor = v_color;\n}\n"},function(t,e,r){"use strict";var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=r(2),s=r(0),c=o(r(45)),l=o(r(14)),h=function(t){function e(e){var r=t.call(this,e,c.default,l.default,4,7)||this,i=e.createBuffer();if(null===i)throw new Error("sigma/renderers/webgl/program/edge.EdgeClampedProgram: error while getting resolutionLocation");r.indicesBuffer=i,r.normalLocation=e.getAttribLocation(r.program,"a_normal"),r.thicknessLocation=e.getAttribLocation(r.program,"a_thickness"),r.radiusLocation=e.getAttribLocation(r.program,"a_radius");var n=e.getUniformLocation(r.program,"u_resolution");if(null===n)throw new Error("sigma/renderers/webgl/program/edge.EdgeClampedProgram: error while getting resolutionLocation");r.resolutionLocation=n;var o=e.getUniformLocation(r.program,"u_ratio");if(null===o)throw new Error("sigma/renderers/webgl/program/edge.EdgeClampedProgram: error while getting ratioLocation");r.ratioLocation=o;var a=e.getUniformLocation(r.program,"u_scale");if(null===a)throw new Error("sigma/renderers/webgl/program/edge.EdgeClampedProgram: error while getting scaleLocation");return r.scaleLocation=a,r.canUse32BitsIndices=s.canUse32BitsIndices(e),r.IndicesArray=r.canUse32BitsIndices?Uint32Array:Uint16Array,r.indicesArray=new r.IndicesArray,r.indicesType=r.canUse32BitsIndices?e.UNSIGNED_INT:e.UNSIGNED_SHORT,r.bind(),r}return n(e,t),e.prototype.bind=function(){var t=this.gl;t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indicesBuffer),t.enableVertexAttribArray(this.positionLocation),t.enableVertexAttribArray(this.normalLocation),t.enableVertexAttribArray(this.thicknessLocation),t.enableVertexAttribArray(this.colorLocation),t.enableVertexAttribArray(this.radiusLocation),t.vertexAttribPointer(this.positionLocation,2,t.FLOAT,!1,7*Float32Array.BYTES_PER_ELEMENT,0),t.vertexAttribPointer(this.normalLocation,2,t.FLOAT,!1,7*Float32Array.BYTES_PER_ELEMENT,8),t.vertexAttribPointer(this.thicknessLocation,1,t.FLOAT,!1,7*Float32Array.BYTES_PER_ELEMENT,16),t.vertexAttribPointer(this.colorLocation,4,t.UNSIGNED_BYTE,!0,7*Float32Array.BYTES_PER_ELEMENT,20),t.vertexAttribPointer(this.radiusLocation,1,t.FLOAT,!1,7*Float32Array.BYTES_PER_ELEMENT,24)},e.prototype.process=function(t,e,r,i){if(t.hidden||e.hidden||r.hidden)for(var n=28*i,o=n+28;n<o;n++)this.array[n]=0;else{var a=r.size||1,c=t.x,l=t.y,h=e.x,u=e.y,d=e.size||1,f=s.floatColor(r.color),p=h-c,g=u-l,m=p*p+g*g,v=0,y=0;m&&(v=-g*(m=1/Math.sqrt(m)),y=p*m);var _=28*i,b=this.array;b[_++]=c,b[_++]=l,b[_++]=v,b[_++]=y,b[_++]=a,b[_++]=f,b[_++]=0,b[_++]=c,b[_++]=l,b[_++]=-v,b[_++]=-y,b[_++]=a,b[_++]=f,b[_++]=0,b[_++]=h,b[_++]=u,b[_++]=v,b[_++]=y,b[_++]=a,b[_++]=f,b[_++]=d,b[_++]=h,b[_++]=u,b[_++]=-v,b[_++]=-y,b[_++]=a,b[_++]=f,b[_]=-d}},e.prototype.computeIndices=function(){for(var t=this.array.length/7,e=t+t/2,r=new this.IndicesArray(e),i=0,n=0;i<t;i+=4)r[n++]=i,r[n++]=i+1,r[n++]=i+2,r[n++]=i+2,r[n++]=i+1,r[n++]=i+3;this.indicesArray=r},e.prototype.bufferData=function(){t.prototype.bufferData.call(this);var e=this.gl;e.bufferData(e.ELEMENT_ARRAY_BUFFER,this.indicesArray,e.STATIC_DRAW)},e.prototype.render=function(t){var e=this.gl,r=this.program;e.useProgram(r),e.uniform2f(this.resolutionLocation,t.width,t.height),e.uniform1f(this.ratioLocation,t.ratio),e.uniformMatrix3fv(this.matrixLocation,!1,t.matrix),e.uniform1f(this.scaleLocation,t.scalingRatio),e.drawElements(e.TRIANGLES,this.indicesArray.length,this.indicesType,0)},e}(a.AbstractEdgeProgram);e.default=h},function(t,e,r){"use strict";r.r(e),e.default="attribute vec2 a_position;\nattribute vec2 a_normal;\nattribute float a_thickness;\nattribute vec4 a_color;\nattribute float a_radius;\n\nuniform vec2 u_resolution;\nuniform float u_ratio;\nuniform mat3 u_matrix;\nuniform float u_scale;\n\nvarying vec4 v_color;\nvarying vec2 v_normal;\nvarying float v_thickness;\n\nconst float min_thickness = 1.8;\nconst float bias = 255.0 / 254.0;\n\nvoid main() {\n\n  // Computing thickness in pixels\n  float pow_ratio = 1.0 / pow(u_ratio, 0.5);\n  float thickness = a_thickness * pow_ratio / u_scale;\n\n  // Min thickness for AA\n  thickness = max(min_thickness, thickness);\n\n  // Arrow margin\n  // NOTE: it seems we don't need a constant margin into the arrow\n  float arrow_pow_ratio = pow_ratio * 2.0;\n  float radius = abs(a_radius) * arrow_pow_ratio;\n  float arrow_thickness = max(a_thickness * 2.5, 5.0) * arrow_pow_ratio / u_scale;\n  float margin = radius + arrow_thickness - arrow_pow_ratio;\n  float direction = sign(a_radius);\n  vec2 pnormal = vec2(-direction * a_normal.y, direction * a_normal.x);\n\n  // Computing delta relative to viewport\n  vec2 delta = (a_normal * thickness) / u_resolution;\n  vec2 clamped = (pnormal * margin) / u_resolution;\n\n  vec2 position = (u_matrix * vec3(a_position, 1)).xy;\n  position += delta + clamped;\n\n  // Applying\n  gl_Position = vec4(position, 0, 1);\n\n  v_normal = a_normal;\n  v_thickness = thickness;\n\n  // Extract the color:\n  v_color = a_color;\n  v_color.a *= bias;\n}\n"}])}));