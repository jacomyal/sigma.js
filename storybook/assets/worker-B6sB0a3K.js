import{a as be}from"./_commonjsHelpers-C4iS2aBk.js";import{r as ye}from"./sigma-BsJT_GRv.js";import{r as Ie}from"./getters-CXJ0gpj8.js";import{r as Oe,a as oe}from"./index-BUEWZHga.js";var ie,pe;function Se(){return pe||(pe=1,ie=function(){var j,X,L={};(function(){var g=0,l=1,h=2,i=3,R=4,O=5,a=6,B=7,Y=8,ve=9,we=0,De=1,ke=2,_=0,o=1,b=2,q=3,U=4,D=5,I=6,T=7,W=8,Ee=3,A=10,_e=3,G=9,he=10;L.exports=function(c,e,d){var fe,n,s,p,k,m,V,y,u,ue,F=e.length,Ge=d.length,Q=c.adjustSizes,Re=c.barnesHutTheta*c.barnesHutTheta,M,w,v,E,C,f,r,t=[];for(s=0;s<F;s+=A)e[s+R]=e[s+h],e[s+O]=e[s+i],e[s+h]=0,e[s+i]=0;if(c.outboundAttractionDistribution){for(M=0,s=0;s<F;s+=A)M+=e[s+a];M/=F/A}if(c.barnesHutOptimize){var P=1/0,Z=-1/0,H=1/0,J=-1/0,S,K,le;for(s=0;s<F;s+=A)P=Math.min(P,e[s+g]),Z=Math.max(Z,e[s+g]),H=Math.min(H,e[s+l]),J=Math.max(J,e[s+l]);var N=Z-P,x=J-H;for(N>x?(H-=(N-x)/2,J=H+N):(P-=(x-N)/2,Z=P+x),t[0+_]=-1,t[0+o]=(P+Z)/2,t[0+b]=(H+J)/2,t[0+q]=Math.max(Z-P,J-H),t[0+U]=-1,t[0+D]=-1,t[0+I]=0,t[0+T]=0,t[0+W]=0,fe=1,s=0;s<F;s+=A)for(n=0,le=Ee;;)if(t[n+D]>=0){e[s+g]<t[n+o]?e[s+l]<t[n+b]?S=t[n+D]:S=t[n+D]+G:e[s+l]<t[n+b]?S=t[n+D]+G*2:S=t[n+D]+G*3,t[n+T]=(t[n+T]*t[n+I]+e[s+g]*e[s+a])/(t[n+I]+e[s+a]),t[n+W]=(t[n+W]*t[n+I]+e[s+l]*e[s+a])/(t[n+I]+e[s+a]),t[n+I]+=e[s+a],n=S;continue}else if(t[n+_]<0){t[n+_]=s;break}else{if(t[n+D]=fe*G,y=t[n+q]/2,u=t[n+D],t[u+_]=-1,t[u+o]=t[n+o]-y,t[u+b]=t[n+b]-y,t[u+q]=y,t[u+U]=u+G,t[u+D]=-1,t[u+I]=0,t[u+T]=0,t[u+W]=0,u+=G,t[u+_]=-1,t[u+o]=t[n+o]-y,t[u+b]=t[n+b]+y,t[u+q]=y,t[u+U]=u+G,t[u+D]=-1,t[u+I]=0,t[u+T]=0,t[u+W]=0,u+=G,t[u+_]=-1,t[u+o]=t[n+o]+y,t[u+b]=t[n+b]-y,t[u+q]=y,t[u+U]=u+G,t[u+D]=-1,t[u+I]=0,t[u+T]=0,t[u+W]=0,u+=G,t[u+_]=-1,t[u+o]=t[n+o]+y,t[u+b]=t[n+b]+y,t[u+q]=y,t[u+U]=t[n+U],t[u+D]=-1,t[u+I]=0,t[u+T]=0,t[u+W]=0,fe+=4,e[t[n+_]+g]<t[n+o]?e[t[n+_]+l]<t[n+b]?S=t[n+D]:S=t[n+D]+G:e[t[n+_]+l]<t[n+b]?S=t[n+D]+G*2:S=t[n+D]+G*3,t[n+I]=e[t[n+_]+a],t[n+T]=e[t[n+_]+g],t[n+W]=e[t[n+_]+l],t[S+_]=t[n+_],t[n+_]=-1,e[s+g]<t[n+o]?e[s+l]<t[n+b]?K=t[n+D]:K=t[n+D]+G:e[s+l]<t[n+b]?K=t[n+D]+G*2:K=t[n+D]+G*3,S===K)if(le--){n=S;continue}else{le=Ee;break}t[K+_]=s;break}}if(c.barnesHutOptimize)for(w=c.scalingRatio,s=0;s<F;s+=A)for(n=0;;)if(t[n+D]>=0)if(f=Math.pow(e[s+g]-t[n+T],2)+Math.pow(e[s+l]-t[n+W],2),ue=t[n+q],4*ue*ue/f<Re){if(v=e[s+g]-t[n+T],E=e[s+l]-t[n+W],Q===!0?f>0?(r=w*e[s+a]*t[n+I]/f,e[s+h]+=v*r,e[s+i]+=E*r):f<0&&(r=-w*e[s+a]*t[n+I]/Math.sqrt(f),e[s+h]+=v*r,e[s+i]+=E*r):f>0&&(r=w*e[s+a]*t[n+I]/f,e[s+h]+=v*r,e[s+i]+=E*r),n=t[n+U],n<0)break;continue}else{n=t[n+D];continue}else{if(m=t[n+_],m>=0&&m!==s&&(v=e[s+g]-e[m+g],E=e[s+l]-e[m+l],f=v*v+E*E,Q===!0?f>0?(r=w*e[s+a]*e[m+a]/f,e[s+h]+=v*r,e[s+i]+=E*r):f<0&&(r=-w*e[s+a]*e[m+a]/Math.sqrt(f),e[s+h]+=v*r,e[s+i]+=E*r):f>0&&(r=w*e[s+a]*e[m+a]/f,e[s+h]+=v*r,e[s+i]+=E*r)),n=t[n+U],n<0)break;continue}else for(w=c.scalingRatio,p=0;p<F;p+=A)for(k=0;k<p;k+=A)v=e[p+g]-e[k+g],E=e[p+l]-e[k+l],Q===!0?(f=Math.sqrt(v*v+E*E)-e[p+Y]-e[k+Y],f>0?(r=w*e[p+a]*e[k+a]/f/f,e[p+h]+=v*r,e[p+i]+=E*r,e[k+h]-=v*r,e[k+i]-=E*r):f<0&&(r=100*w*e[p+a]*e[k+a],e[p+h]+=v*r,e[p+i]+=E*r,e[k+h]-=v*r,e[k+i]-=E*r)):(f=Math.sqrt(v*v+E*E),f>0&&(r=w*e[p+a]*e[k+a]/f/f,e[p+h]+=v*r,e[p+i]+=E*r,e[k+h]-=v*r,e[k+i]-=E*r));for(u=c.gravity/c.scalingRatio,w=c.scalingRatio,s=0;s<F;s+=A)r=0,v=e[s+g],E=e[s+l],f=Math.sqrt(Math.pow(v,2)+Math.pow(E,2)),c.strongGravityMode?f>0&&(r=w*e[s+a]*u):f>0&&(r=w*e[s+a]*u/f),e[s+h]-=v*r,e[s+i]-=E*r;for(w=1*(c.outboundAttractionDistribution?M:1),V=0;V<Ge;V+=_e)p=d[V+we],k=d[V+De],y=d[V+ke],C=Math.pow(y,c.edgeWeightInfluence),v=e[p+g]-e[k+g],E=e[p+l]-e[k+l],Q===!0?(f=Math.sqrt(v*v+E*E)-e[p+Y]-e[k+Y],c.linLogMode?c.outboundAttractionDistribution?f>0&&(r=-w*C*Math.log(1+f)/f/e[p+a]):f>0&&(r=-w*C*Math.log(1+f)/f):c.outboundAttractionDistribution?f>0&&(r=-w*C/e[p+a]):f>0&&(r=-w*C)):(f=Math.sqrt(Math.pow(v,2)+Math.pow(E,2)),c.linLogMode?c.outboundAttractionDistribution?f>0&&(r=-w*C*Math.log(1+f)/f/e[p+a]):f>0&&(r=-w*C*Math.log(1+f)/f):c.outboundAttractionDistribution?(f=1,r=-w*C/e[p+a]):(f=1,r=-w*C)),f>0&&(e[p+h]+=v*r,e[p+i]+=E*r,e[k+h]-=v*r,e[k+i]-=E*r);var ee,$,se,z,te,ne;if(Q===!0)for(s=0;s<F;s+=A)e[s+ve]!==1&&(ee=Math.sqrt(Math.pow(e[s+h],2)+Math.pow(e[s+i],2)),ee>he&&(e[s+h]=e[s+h]*he/ee,e[s+i]=e[s+i]*he/ee),$=e[s+a]*Math.sqrt((e[s+R]-e[s+h])*(e[s+R]-e[s+h])+(e[s+O]-e[s+i])*(e[s+O]-e[s+i])),se=Math.sqrt((e[s+R]+e[s+h])*(e[s+R]+e[s+h])+(e[s+O]+e[s+i])*(e[s+O]+e[s+i]))/2,z=.1*Math.log(1+se)/(1+Math.sqrt($)),te=e[s+g]+e[s+h]*(z/c.slowDown),e[s+g]=te,ne=e[s+l]+e[s+i]*(z/c.slowDown),e[s+l]=ne);else for(s=0;s<F;s+=A)e[s+ve]!==1&&($=e[s+a]*Math.sqrt((e[s+R]-e[s+h])*(e[s+R]-e[s+h])+(e[s+O]-e[s+i])*(e[s+O]-e[s+i])),se=Math.sqrt((e[s+R]+e[s+h])*(e[s+R]+e[s+h])+(e[s+O]+e[s+i])*(e[s+O]+e[s+i]))/2,z=e[s+B]*Math.log(1+se)/(1+Math.sqrt($)),e[s+B]=Math.min(1,Math.sqrt(z*(Math.pow(e[s+h],2)+Math.pow(e[s+i],2))/(1+Math.sqrt($)))),te=e[s+g]+e[s+h]*(z/c.slowDown),e[s+g]=te,ne=e[s+l]+e[s+i]*(z/c.slowDown),e[s+l]=ne);return{}}})();var re=L.exports;self.addEventListener("message",function(g){var l=g.data;j=new Float32Array(l.nodes),l.edges&&(X=new Float32Array(l.edges)),re(l.settings,j,X),self.postMessage({nodes:j.buffer},[j.buffer])})}),ie}var ae,ce;function Ae(){if(ce)return ae;ce=1;var ge=Se(),j=ye(),X=Ie().createEdgeWeightGetter,L=Oe(),re=oe();function g(l,h){if(h=h||{},!j(l))throw new Error("graphology-layout-forceatlas2/worker: the given graph is not a valid graphology instance.");var i=X("getEdgeWeight"in h?h.getEdgeWeight:"weight").fromEntry,R=L.assign({},re,h.settings),O=L.validateSettings(R);if(O)throw new Error("graphology-layout-forceatlas2/worker: "+O.message);this.worker=null,this.graph=l,this.settings=R,this.getEdgeWeight=i,this.matrices=null,this.running=!1,this.killed=!1,this.outputReducer=typeof h.outputReducer=="function"?h.outputReducer:null,this.handleMessage=this.handleMessage.bind(this);var a=void 0,B=this;this.handleGraphUpdate=function(){B.worker&&B.worker.terminate(),a&&clearTimeout(a),a=setTimeout(function(){a=void 0,B.spawnWorker()},0)},l.on("nodeAdded",this.handleGraphUpdate),l.on("edgeAdded",this.handleGraphUpdate),l.on("nodeDropped",this.handleGraphUpdate),l.on("edgeDropped",this.handleGraphUpdate),this.spawnWorker()}return g.prototype.isRunning=function(){return this.running},g.prototype.spawnWorker=function(){this.worker&&this.worker.terminate(),this.worker=L.createWorker(ge),this.worker.addEventListener("message",this.handleMessage),this.running&&(this.running=!1,this.start())},g.prototype.handleMessage=function(l){if(this.running){var h=new Float32Array(l.data.nodes);L.assignLayoutChanges(this.graph,h,this.outputReducer),this.outputReducer&&L.readGraphPositions(this.graph,h),this.matrices.nodes=h,this.askForIterations()}},g.prototype.askForIterations=function(l){var h=this.matrices,i={settings:this.settings,nodes:h.nodes.buffer},R=[h.nodes.buffer];return l&&(i.edges=h.edges.buffer,R.push(h.edges.buffer)),this.worker.postMessage(i,R),this},g.prototype.start=function(){if(this.killed)throw new Error("graphology-layout-forceatlas2/worker.start: layout was killed.");return this.running?this:(this.matrices=L.graphToByteArrays(this.graph,this.getEdgeWeight),this.running=!0,this.askForIterations(!0),this)},g.prototype.stop=function(){return this.running=!1,this},g.prototype.kill=function(){if(this.killed)return this;this.running=!1,this.killed=!0,this.matrices=null,this.worker.terminate(),this.graph.removeListener("nodeAdded",this.handleGraphUpdate),this.graph.removeListener("edgeAdded",this.handleGraphUpdate),this.graph.removeListener("nodeDropped",this.handleGraphUpdate),this.graph.removeListener("edgeDropped",this.handleGraphUpdate)},ae=g,ae}var Te=Ae();const me=be(Te);export{me as F};
